<!DOCTYPE HTML>
<html lang="zh-TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>第5章 原子性底層 - 高並發編程通用概念（跨 Java/C++/Rust/Go）</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/ascii-diagram.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">高並發編程通用概念（跨 Java/C++/Rust/Go）</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="第5章-原子性底層"><a class="header" href="#第5章-原子性底層">第5章 原子性底層</a></h1>
<h2 id="51-原子性定義"><a class="header" href="#51-原子性定義">5.1 原子性定義</a></h2>
<!-- subsection-diagram -->
<h3 id="本小節示意圖"><a class="header" href="#本小節示意圖">本小節示意圖</a></h3>
<div class="ascii-svg-wrap">
<svg class="ascii-svg" xmlns="http://www.w3.org/2000/svg" width="768" height="924" viewBox="0 0 768 924" role="img" aria-label="ASCII diagram">
<g fill="currentColor" font-family="Noto Sans Mono CJK TC, Noto Sans Mono CJK SC, Noto Sans Mono CJK JP, Sarasa Mono TC, Cascadia Mono, JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, monospace" font-size="16" text-rendering="geometricPrecision" xml:space="preserve">
<text x="14" y="14">原</text>
<text x="34" y="14">子</text>
<text x="54" y="14">性</text>
<text x="74" y="14">定</text>
<text x="94" y="14">義</text>
<text x="114" y="14">：</text>
<text x="134" y="14">「</text>
<text x="154" y="14">不</text>
<text x="174" y="14">可</text>
<text x="194" y="14">被</text>
<text x="214" y="14">拆</text>
<text x="234" y="14">開</text>
<text x="254" y="14">觀</text>
<text x="274" y="14">察</text>
<text x="294" y="14">，</text>
<text x="314" y="14">要</text>
<text x="334" y="14">嘛</text>
<text x="354" y="14">全</text>
<text x="374" y="14">成</text>
<text x="394" y="14">功</text>
<text x="414" y="14">，</text>
<text x="434" y="14">要</text>
<text x="454" y="14">嘛</text>
<text x="474" y="14">回</text>
<text x="494" y="14">到</text>
<text x="514" y="14">原</text>
<text x="534" y="14">狀</text>
<text x="554" y="14">」</text>
<text x="34" y="54">骰</text>
<text x="54" y="54">子</text>
<text x="74" y="54">比</text>
<text x="94" y="54">喻</text>
<text x="114" y="54">（</text>
<text x="134" y="54">原</text>
<text x="154" y="54">子</text>
<text x="174" y="54">操</text>
<text x="194" y="54">作</text>
<text x="214" y="54">的</text>
<text x="234" y="54">語</text>
<text x="254" y="54">意</text>
<text x="274" y="54">）</text>
<text x="294" y="54">：</text>
<text x="34" y="94">┌</text>
<text x="44" y="94">─</text>
<text x="54" y="94">─</text>
<text x="64" y="94">─</text>
<text x="74" y="94">─</text>
<text x="84" y="94">─</text>
<text x="94" y="94">─</text>
<text x="104" y="94">─</text>
<text x="114" y="94">─</text>
<text x="124" y="94">─</text>
<text x="134" y="94">─</text>
<text x="144" y="94">─</text>
<text x="154" y="94">─</text>
<text x="164" y="94">─</text>
<text x="174" y="94">─</text>
<text x="184" y="94">─</text>
<text x="194" y="94">─</text>
<text x="204" y="94">─</text>
<text x="214" y="94">─</text>
<text x="224" y="94">─</text>
<text x="234" y="94">─</text>
<text x="244" y="94">─</text>
<text x="254" y="94">─</text>
<text x="264" y="94">─</text>
<text x="274" y="94">─</text>
<text x="284" y="94">─</text>
<text x="294" y="94">─</text>
<text x="304" y="94">─</text>
<text x="314" y="94">─</text>
<text x="324" y="94">─</text>
<text x="334" y="94">─</text>
<text x="344" y="94">─</text>
<text x="354" y="94">─</text>
<text x="364" y="94">─</text>
<text x="374" y="94">─</text>
<text x="384" y="94">─</text>
<text x="394" y="94">─</text>
<text x="404" y="94">─</text>
<text x="414" y="94">─</text>
<text x="424" y="94">─</text>
<text x="434" y="94">─</text>
<text x="444" y="94">─</text>
<text x="454" y="94">─</text>
<text x="464" y="94">─</text>
<text x="474" y="94">─</text>
<text x="484" y="94">─</text>
<text x="494" y="94">─</text>
<text x="504" y="94">─</text>
<text x="514" y="94">─</text>
<text x="524" y="94">─</text>
<text x="534" y="94">─</text>
<text x="544" y="94">─</text>
<text x="554" y="94">─</text>
<text x="564" y="94">─</text>
<text x="574" y="94">─</text>
<text x="584" y="94">─</text>
<text x="594" y="94">─</text>
<text x="604" y="94">─</text>
<text x="614" y="94">─</text>
<text x="624" y="94">─</text>
<text x="634" y="94">─</text>
<text x="644" y="94">─</text>
<text x="654" y="94">─</text>
<text x="664" y="94">─</text>
<text x="674" y="94">─</text>
<text x="684" y="94">─</text>
<text x="694" y="94">─</text>
<text x="704" y="94">─</text>
<text x="714" y="94">─</text>
<text x="724" y="94">─</text>
<text x="734" y="94">─</text>
<text x="744" y="94">┐</text>
<text x="34" y="114">│</text>
<text x="64" y="114">原</text>
<text x="84" y="114">子</text>
<text x="104" y="114">操</text>
<text x="124" y="114">作</text>
<text x="144" y="114">（</text>
<text x="164" y="114">A</text>
<text x="174" y="114">t</text>
<text x="184" y="114">o</text>
<text x="194" y="114">m</text>
<text x="204" y="114">i</text>
<text x="214" y="114">c</text>
<text x="224" y="114">）</text>
<text x="744" y="114">│</text>
<text x="74" y="134">│</text>
<text x="744" y="134">│</text>
<text x="34" y="154">│</text>
<text x="64" y="154">狀</text>
<text x="84" y="154">態</text>
<text x="114" y="154">A</text>
<text x="134" y="154">─</text>
<text x="144" y="154">─</text>
<text x="154" y="154">─</text>
<text x="164" y="154">─</text>
<text x="174" y="154">─</text>
<text x="184" y="154">─</text>
<text x="194" y="154">─</text>
<text x="204" y="154">─</text>
<text x="214" y="154">─</text>
<text x="224" y="154">─</text>
<text x="234" y="154">─</text>
<text x="244" y="154">─</text>
<text x="254" y="154">─</text>
<text x="264" y="154">─</text>
<text x="274" y="154">─</text>
<text x="284" y="154">─</text>
<text x="294" y="154">─</text>
<text x="304" y="154">─</text>
<text x="314" y="154">─</text>
<text x="324" y="154">─</text>
<text x="334" y="154">─</text>
<text x="344" y="154">─</text>
<text x="354" y="154">─</text>
<text x="364" y="154">─</text>
<text x="374" y="154">─</text>
<text x="384" y="154">─</text>
<text x="394" y="154">─</text>
<text x="404" y="154">─</text>
<text x="414" y="154">─</text>
<text x="424" y="154">─</text>
<text x="434" y="154">─</text>
<text x="444" y="154">─</text>
<text x="454" y="154">─</text>
<text x="464" y="154">─</text>
<text x="474" y="154">─</text>
<text x="484" y="154">─</text>
<text x="494" y="154">─</text>
<text x="504" y="154">─</text>
<text x="514" y="154">►</text>
<text x="534" y="154">狀</text>
<text x="554" y="154">態</text>
<text x="584" y="154">B</text>
<text x="744" y="154">│</text>
<text x="34" y="174">│</text>
<text x="74" y="174">(</text>
<text x="84" y="174">x</text>
<text x="94" y="174">=</text>
<text x="104" y="174">0</text>
<text x="114" y="174">)</text>
<text x="214" y="174">不</text>
<text x="234" y="174">可</text>
<text x="254" y="174">見</text>
<text x="274" y="174">中</text>
<text x="294" y="174">間</text>
<text x="314" y="174">態</text>
<text x="544" y="174">(</text>
<text x="554" y="174">x</text>
<text x="564" y="174">=</text>
<text x="574" y="174">1</text>
<text x="584" y="174">)</text>
<text x="744" y="174">│</text>
<text x="74" y="194">│</text>
<text x="744" y="194">│</text>
<text x="34" y="214">│</text>
<text x="64" y="214">其</text>
<text x="84" y="214">他</text>
<text x="104" y="214">執</text>
<text x="124" y="214">行</text>
<text x="144" y="214">緒</text>
<text x="164" y="214">只</text>
<text x="184" y="214">能</text>
<text x="204" y="214">看</text>
<text x="224" y="214">到</text>
<text x="254" y="214">A</text>
<text x="274" y="214">或</text>
<text x="304" y="214">B</text>
<text x="314" y="214">，</text>
<text x="334" y="214">永</text>
<text x="354" y="214">遠</text>
<text x="374" y="214">看</text>
<text x="394" y="214">不</text>
<text x="414" y="214">到</text>
<text x="434" y="214">「</text>
<text x="454" y="214">介</text>
<text x="474" y="214">於</text>
<text x="494" y="214">中</text>
<text x="514" y="214">間</text>
<text x="534" y="214">的</text>
<text x="554" y="214">半</text>
<text x="574" y="214">完</text>
<text x="594" y="214">成</text>
<text x="614" y="214">狀</text>
<text x="634" y="214">態</text>
<text x="654" y="214">」</text>
<text x="744" y="214">│</text>
<text x="34" y="234">│</text>
<text x="314" y="234">✓</text>
<text x="334" y="234">成</text>
<text x="354" y="234">功</text>
<text x="744" y="234">│</text>
<text x="34" y="254">└</text>
<text x="44" y="254">─</text>
<text x="54" y="254">─</text>
<text x="64" y="254">─</text>
<text x="74" y="254">─</text>
<text x="84" y="254">─</text>
<text x="94" y="254">─</text>
<text x="104" y="254">─</text>
<text x="114" y="254">─</text>
<text x="124" y="254">─</text>
<text x="134" y="254">─</text>
<text x="144" y="254">─</text>
<text x="154" y="254">─</text>
<text x="164" y="254">─</text>
<text x="174" y="254">─</text>
<text x="184" y="254">─</text>
<text x="194" y="254">─</text>
<text x="204" y="254">─</text>
<text x="214" y="254">─</text>
<text x="224" y="254">─</text>
<text x="234" y="254">─</text>
<text x="244" y="254">─</text>
<text x="254" y="254">─</text>
<text x="264" y="254">─</text>
<text x="274" y="254">─</text>
<text x="284" y="254">─</text>
<text x="294" y="254">─</text>
<text x="304" y="254">─</text>
<text x="314" y="254">─</text>
<text x="324" y="254">─</text>
<text x="334" y="254">─</text>
<text x="344" y="254">─</text>
<text x="354" y="254">─</text>
<text x="364" y="254">─</text>
<text x="374" y="254">─</text>
<text x="384" y="254">─</text>
<text x="394" y="254">─</text>
<text x="404" y="254">─</text>
<text x="414" y="254">─</text>
<text x="424" y="254">─</text>
<text x="434" y="254">─</text>
<text x="444" y="254">─</text>
<text x="454" y="254">─</text>
<text x="464" y="254">─</text>
<text x="474" y="254">─</text>
<text x="484" y="254">─</text>
<text x="494" y="254">─</text>
<text x="504" y="254">─</text>
<text x="514" y="254">─</text>
<text x="524" y="254">─</text>
<text x="534" y="254">─</text>
<text x="544" y="254">─</text>
<text x="554" y="254">─</text>
<text x="564" y="254">─</text>
<text x="574" y="254">─</text>
<text x="584" y="254">─</text>
<text x="594" y="254">─</text>
<text x="604" y="254">─</text>
<text x="614" y="254">─</text>
<text x="624" y="254">─</text>
<text x="634" y="254">─</text>
<text x="644" y="254">─</text>
<text x="654" y="254">─</text>
<text x="664" y="254">─</text>
<text x="674" y="254">─</text>
<text x="684" y="254">─</text>
<text x="694" y="254">─</text>
<text x="704" y="254">─</text>
<text x="714" y="254">─</text>
<text x="724" y="254">─</text>
<text x="734" y="254">─</text>
<text x="744" y="254">┘</text>
<text x="34" y="294">非</text>
<text x="54" y="294">原</text>
<text x="74" y="294">子</text>
<text x="94" y="294">操</text>
<text x="114" y="294">作</text>
<text x="134" y="294">（</text>
<text x="154" y="294">N</text>
<text x="164" y="294">o</text>
<text x="174" y="294">n</text>
<text x="184" y="294">-</text>
<text x="194" y="294">A</text>
<text x="204" y="294">t</text>
<text x="214" y="294">o</text>
<text x="224" y="294">m</text>
<text x="234" y="294">i</text>
<text x="244" y="294">c</text>
<text x="254" y="294">）</text>
<text x="274" y="294">：</text>
<text x="294" y="294">x</text>
<text x="304" y="294">+</text>
<text x="314" y="294">+</text>
<text x="334" y="294">的</text>
<text x="354" y="294">危</text>
<text x="374" y="294">險</text>
<text x="394" y="294">：</text>
<text x="34" y="334">┌</text>
<text x="44" y="334">─</text>
<text x="54" y="334">─</text>
<text x="64" y="334">─</text>
<text x="74" y="334">─</text>
<text x="84" y="334">─</text>
<text x="94" y="334">─</text>
<text x="104" y="334">─</text>
<text x="114" y="334">─</text>
<text x="124" y="334">─</text>
<text x="134" y="334">─</text>
<text x="144" y="334">─</text>
<text x="154" y="334">─</text>
<text x="164" y="334">─</text>
<text x="174" y="334">─</text>
<text x="184" y="334">─</text>
<text x="194" y="334">─</text>
<text x="204" y="334">─</text>
<text x="214" y="334">─</text>
<text x="224" y="334">─</text>
<text x="234" y="334">─</text>
<text x="244" y="334">─</text>
<text x="254" y="334">─</text>
<text x="264" y="334">─</text>
<text x="274" y="334">─</text>
<text x="284" y="334">─</text>
<text x="294" y="334">─</text>
<text x="304" y="334">─</text>
<text x="314" y="334">─</text>
<text x="324" y="334">─</text>
<text x="334" y="334">─</text>
<text x="344" y="334">─</text>
<text x="354" y="334">─</text>
<text x="364" y="334">─</text>
<text x="374" y="334">─</text>
<text x="384" y="334">─</text>
<text x="394" y="334">─</text>
<text x="404" y="334">─</text>
<text x="414" y="334">─</text>
<text x="424" y="334">─</text>
<text x="434" y="334">─</text>
<text x="444" y="334">─</text>
<text x="454" y="334">─</text>
<text x="464" y="334">─</text>
<text x="474" y="334">─</text>
<text x="484" y="334">─</text>
<text x="494" y="334">─</text>
<text x="504" y="334">─</text>
<text x="514" y="334">─</text>
<text x="524" y="334">─</text>
<text x="534" y="334">─</text>
<text x="544" y="334">─</text>
<text x="554" y="334">─</text>
<text x="564" y="334">─</text>
<text x="574" y="334">─</text>
<text x="584" y="334">─</text>
<text x="594" y="334">─</text>
<text x="604" y="334">─</text>
<text x="614" y="334">─</text>
<text x="624" y="334">─</text>
<text x="634" y="334">─</text>
<text x="644" y="334">─</text>
<text x="654" y="334">─</text>
<text x="664" y="334">─</text>
<text x="674" y="334">─</text>
<text x="684" y="334">─</text>
<text x="694" y="334">─</text>
<text x="704" y="334">─</text>
<text x="714" y="334">─</text>
<text x="724" y="334">─</text>
<text x="734" y="334">─</text>
<text x="744" y="334">┐</text>
<text x="34" y="354">│</text>
<text x="64" y="354">非</text>
<text x="84" y="354">原</text>
<text x="104" y="354">子</text>
<text x="124" y="354">操</text>
<text x="144" y="354">作</text>
<text x="164" y="354">（</text>
<text x="184" y="354">x</text>
<text x="194" y="354">+</text>
<text x="204" y="354">+</text>
<text x="214" y="354">）</text>
<text x="744" y="354">│</text>
<text x="74" y="374">│</text>
<text x="744" y="374">│</text>
<text x="34" y="394">│</text>
<text x="64" y="394">狀</text>
<text x="84" y="394">態</text>
<text x="114" y="394">A</text>
<text x="214" y="394">中</text>
<text x="234" y="394">間</text>
<text x="254" y="394">態</text>
<text x="274" y="394">（</text>
<text x="294" y="394">可</text>
<text x="314" y="394">被</text>
<text x="334" y="394">觀</text>
<text x="354" y="394">察</text>
<text x="374" y="394">！</text>
<text x="394" y="394">）</text>
<text x="524" y="394">狀</text>
<text x="544" y="394">態</text>
<text x="574" y="394">B</text>
<text x="744" y="394">│</text>
<text x="34" y="414">│</text>
<text x="74" y="414">(</text>
<text x="84" y="414">x</text>
<text x="94" y="414">=</text>
<text x="104" y="414">0</text>
<text x="114" y="414">)</text>
<text x="524" y="414">(</text>
<text x="534" y="414">x</text>
<text x="544" y="414">=</text>
<text x="554" y="414">1</text>
<text x="564" y="414">)</text>
<text x="744" y="414">│</text>
<text x="84" y="434">│</text>
<text x="144" y="434">│</text>
<text x="594" y="434">│</text>
<text x="744" y="434">│</text>
<text x="34" y="454">│</text>
<text x="94" y="454">▼</text>
<text x="544" y="454">▼</text>
<text x="744" y="454">│</text>
<text x="34" y="474">│</text>
<text x="64" y="474">①</text>
<text x="84" y="474">L</text>
<text x="94" y="474">O</text>
<text x="104" y="474">A</text>
<text x="114" y="474">D</text>
<text x="134" y="474">r</text>
<text x="144" y="474">1</text>
<text x="154" y="474">=</text>
<text x="164" y="474">0</text>
<text x="194" y="474">─</text>
<text x="204" y="474">─</text>
<text x="214" y="474">─</text>
<text x="224" y="474">─</text>
<text x="234" y="474">─</text>
<text x="244" y="474">─</text>
<text x="254" y="474">─</text>
<text x="264" y="474">─</text>
<text x="274" y="474">─</text>
<text x="284" y="474">─</text>
<text x="294" y="474">─</text>
<text x="304" y="474">─</text>
<text x="314" y="474">─</text>
<text x="324" y="474">─</text>
<text x="334" y="474">─</text>
<text x="344" y="474">─</text>
<text x="354" y="474">─</text>
<text x="364" y="474">─</text>
<text x="374" y="474">─</text>
<text x="384" y="474">─</text>
<text x="394" y="474">─</text>
<text x="404" y="474">─</text>
<text x="414" y="474">─</text>
<text x="424" y="474">─</text>
<text x="434" y="474">─</text>
<text x="444" y="474">►</text>
<text x="474" y="474">③</text>
<text x="494" y="474">S</text>
<text x="504" y="474">T</text>
<text x="514" y="474">O</text>
<text x="524" y="474">R</text>
<text x="534" y="474">E</text>
<text x="554" y="474">x</text>
<text x="564" y="474">=</text>
<text x="574" y="474">1</text>
<text x="744" y="474">│</text>
<text x="34" y="494">│</text>
<text x="254" y="494">▲</text>
<text x="744" y="494">│</text>
<text x="84" y="514">│</text>
<text x="304" y="514">│</text>
<text x="744" y="514">│</text>
<text x="34" y="534">│</text>
<text x="184" y="534">②</text>
<text x="204" y="534">A</text>
<text x="214" y="534">D</text>
<text x="224" y="534">D</text>
<text x="244" y="534">r</text>
<text x="254" y="534">1</text>
<text x="264" y="534">=</text>
<text x="274" y="534">r</text>
<text x="284" y="534">1</text>
<text x="294" y="534">+</text>
<text x="304" y="534">1</text>
<text x="744" y="534">│</text>
<text x="34" y="554">│</text>
<text x="184" y="554">（</text>
<text x="204" y="554">r</text>
<text x="214" y="554">1</text>
<text x="234" y="554">在</text>
<text x="254" y="554">暫</text>
<text x="274" y="554">存</text>
<text x="294" y="554">器</text>
<text x="314" y="554">，</text>
<text x="744" y="554">│</text>
<text x="34" y="574">│</text>
<text x="194" y="574">此</text>
<text x="214" y="574">刻</text>
<text x="244" y="574">x</text>
<text x="264" y="574">仍</text>
<text x="284" y="574">是</text>
<text x="314" y="574">0</text>
<text x="324" y="574">）</text>
<text x="744" y="574">│</text>
<text x="34" y="594">│</text>
<text x="254" y="594">▲</text>
<text x="744" y="594">│</text>
<text x="34" y="614">│</text>
<text x="184" y="614">其</text>
<text x="204" y="614">他</text>
<text x="224" y="614">執</text>
<text x="244" y="614">行</text>
<text x="264" y="614">緒</text>
<text x="284" y="614">在</text>
<text x="314" y="614">①</text>
<text x="334" y="614">和</text>
<text x="364" y="614">③</text>
<text x="384" y="614">之</text>
<text x="404" y="614">間</text>
<text x="424" y="614">可</text>
<text x="444" y="614">以</text>
<text x="464" y="614">讀</text>
<text x="484" y="614">取</text>
<text x="514" y="614">x</text>
<text x="524" y="614">=</text>
<text x="534" y="614">0</text>
<text x="554" y="614">的</text>
<text x="574" y="614">舊</text>
<text x="594" y="614">值</text>
<text x="614" y="614">！</text>
<text x="744" y="614">│</text>
<text x="34" y="634">└</text>
<text x="44" y="634">─</text>
<text x="54" y="634">─</text>
<text x="64" y="634">─</text>
<text x="74" y="634">─</text>
<text x="84" y="634">─</text>
<text x="94" y="634">─</text>
<text x="104" y="634">─</text>
<text x="114" y="634">─</text>
<text x="124" y="634">─</text>
<text x="134" y="634">─</text>
<text x="144" y="634">─</text>
<text x="154" y="634">─</text>
<text x="164" y="634">─</text>
<text x="174" y="634">─</text>
<text x="184" y="634">─</text>
<text x="194" y="634">─</text>
<text x="204" y="634">─</text>
<text x="214" y="634">─</text>
<text x="224" y="634">─</text>
<text x="234" y="634">─</text>
<text x="244" y="634">─</text>
<text x="254" y="634">─</text>
<text x="264" y="634">─</text>
<text x="274" y="634">─</text>
<text x="284" y="634">─</text>
<text x="294" y="634">─</text>
<text x="304" y="634">─</text>
<text x="314" y="634">─</text>
<text x="324" y="634">─</text>
<text x="334" y="634">─</text>
<text x="344" y="634">─</text>
<text x="354" y="634">─</text>
<text x="364" y="634">─</text>
<text x="374" y="634">─</text>
<text x="384" y="634">─</text>
<text x="394" y="634">─</text>
<text x="404" y="634">─</text>
<text x="414" y="634">─</text>
<text x="424" y="634">─</text>
<text x="434" y="634">─</text>
<text x="444" y="634">─</text>
<text x="454" y="634">─</text>
<text x="464" y="634">─</text>
<text x="474" y="634">─</text>
<text x="484" y="634">─</text>
<text x="494" y="634">─</text>
<text x="504" y="634">─</text>
<text x="514" y="634">─</text>
<text x="524" y="634">─</text>
<text x="534" y="634">─</text>
<text x="544" y="634">─</text>
<text x="554" y="634">─</text>
<text x="564" y="634">─</text>
<text x="574" y="634">─</text>
<text x="584" y="634">─</text>
<text x="594" y="634">─</text>
<text x="604" y="634">─</text>
<text x="614" y="634">─</text>
<text x="624" y="634">─</text>
<text x="634" y="634">─</text>
<text x="644" y="634">─</text>
<text x="654" y="634">─</text>
<text x="664" y="634">─</text>
<text x="674" y="634">─</text>
<text x="684" y="634">─</text>
<text x="694" y="634">─</text>
<text x="704" y="634">─</text>
<text x="714" y="634">─</text>
<text x="724" y="634">─</text>
<text x="734" y="634">─</text>
<text x="744" y="634">┘</text>
<text x="34" y="674">比</text>
<text x="54" y="674">喻</text>
<text x="74" y="674">：</text>
<text x="94" y="674">銀</text>
<text x="114" y="674">行</text>
<text x="134" y="674">轉</text>
<text x="154" y="674">帳</text>
<text x="174" y="674">必</text>
<text x="194" y="674">須</text>
<text x="214" y="674">是</text>
<text x="234" y="674">原</text>
<text x="254" y="674">子</text>
<text x="274" y="674">的</text>
<text x="34" y="694">┌</text>
<text x="44" y="694">─</text>
<text x="54" y="694">─</text>
<text x="64" y="694">─</text>
<text x="74" y="694">─</text>
<text x="84" y="694">─</text>
<text x="94" y="694">─</text>
<text x="104" y="694">─</text>
<text x="114" y="694">─</text>
<text x="124" y="694">─</text>
<text x="134" y="694">─</text>
<text x="144" y="694">─</text>
<text x="154" y="694">─</text>
<text x="164" y="694">─</text>
<text x="174" y="694">─</text>
<text x="184" y="694">─</text>
<text x="194" y="694">─</text>
<text x="204" y="694">─</text>
<text x="214" y="694">─</text>
<text x="224" y="694">─</text>
<text x="234" y="694">─</text>
<text x="244" y="694">─</text>
<text x="254" y="694">─</text>
<text x="264" y="694">─</text>
<text x="274" y="694">─</text>
<text x="284" y="694">─</text>
<text x="294" y="694">─</text>
<text x="304" y="694">─</text>
<text x="314" y="694">─</text>
<text x="324" y="694">─</text>
<text x="334" y="694">─</text>
<text x="344" y="694">─</text>
<text x="354" y="694">─</text>
<text x="364" y="694">─</text>
<text x="374" y="694">─</text>
<text x="384" y="694">─</text>
<text x="394" y="694">─</text>
<text x="404" y="694">─</text>
<text x="414" y="694">─</text>
<text x="424" y="694">─</text>
<text x="434" y="694">─</text>
<text x="444" y="694">─</text>
<text x="454" y="694">─</text>
<text x="464" y="694">─</text>
<text x="474" y="694">─</text>
<text x="484" y="694">─</text>
<text x="494" y="694">─</text>
<text x="504" y="694">─</text>
<text x="514" y="694">─</text>
<text x="524" y="694">─</text>
<text x="534" y="694">─</text>
<text x="544" y="694">─</text>
<text x="554" y="694">─</text>
<text x="564" y="694">─</text>
<text x="574" y="694">─</text>
<text x="584" y="694">─</text>
<text x="594" y="694">─</text>
<text x="604" y="694">─</text>
<text x="614" y="694">─</text>
<text x="624" y="694">─</text>
<text x="634" y="694">─</text>
<text x="644" y="694">─</text>
<text x="654" y="694">─</text>
<text x="664" y="694">─</text>
<text x="674" y="694">─</text>
<text x="684" y="694">─</text>
<text x="694" y="694">─</text>
<text x="704" y="694">─</text>
<text x="714" y="694">─</text>
<text x="724" y="694">─</text>
<text x="734" y="694">─</text>
<text x="744" y="694">┐</text>
<text x="34" y="714">│</text>
<text x="64" y="714">轉</text>
<text x="84" y="714">帳</text>
<text x="114" y="714">$</text>
<text x="124" y="714">1</text>
<text x="134" y="714">0</text>
<text x="144" y="714">0</text>
<text x="154" y="714">：</text>
<text x="174" y="714">扣</text>
<text x="194" y="714">款</text>
<text x="224" y="714">A</text>
<text x="244" y="714">帳</text>
<text x="264" y="714">戶</text>
<text x="294" y="714">+</text>
<text x="314" y="714">入</text>
<text x="334" y="714">款</text>
<text x="364" y="714">B</text>
<text x="384" y="714">帳</text>
<text x="404" y="714">戶</text>
<text x="744" y="714">│</text>
<text x="94" y="734">│</text>
<text x="744" y="734">│</text>
<text x="34" y="754">│</text>
<text x="64" y="754">原</text>
<text x="84" y="754">子</text>
<text x="104" y="754">（</text>
<text x="124" y="754">正</text>
<text x="144" y="754">確</text>
<text x="164" y="754">）</text>
<text x="184" y="754">：</text>
<text x="744" y="754">│</text>
<text x="34" y="774">│</text>
<text x="64" y="774">[</text>
<text x="74" y="774">A</text>
<text x="84" y="774">=</text>
<text x="94" y="774">1</text>
<text x="104" y="774">0</text>
<text x="114" y="774">0</text>
<text x="124" y="774">0</text>
<text x="134" y="774">,</text>
<text x="154" y="774">B</text>
<text x="164" y="774">=</text>
<text x="174" y="774">5</text>
<text x="184" y="774">0</text>
<text x="194" y="774">0</text>
<text x="204" y="774">]</text>
<text x="224" y="774">─</text>
<text x="234" y="774">─</text>
<text x="244" y="774">►</text>
<text x="264" y="774">[</text>
<text x="274" y="774">A</text>
<text x="284" y="774">=</text>
<text x="294" y="774">9</text>
<text x="304" y="774">0</text>
<text x="314" y="774">0</text>
<text x="324" y="774">,</text>
<text x="344" y="774">B</text>
<text x="354" y="774">=</text>
<text x="364" y="774">6</text>
<text x="374" y="774">0</text>
<text x="384" y="774">0</text>
<text x="394" y="774">]</text>
<text x="434" y="774">←</text>
<text x="454" y="774">只</text>
<text x="474" y="774">有</text>
<text x="494" y="774">這</text>
<text x="514" y="774">兩</text>
<text x="534" y="774">種</text>
<text x="554" y="774">狀</text>
<text x="574" y="774">態</text>
<text x="744" y="774">│</text>
<text x="94" y="794">│</text>
<text x="744" y="794">│</text>
<text x="34" y="814">│</text>
<text x="64" y="814">非</text>
<text x="84" y="814">原</text>
<text x="104" y="814">子</text>
<text x="124" y="814">（</text>
<text x="144" y="814">危</text>
<text x="164" y="814">險</text>
<text x="184" y="814">）</text>
<text x="204" y="814">：</text>
<text x="744" y="814">│</text>
<text x="34" y="834">│</text>
<text x="64" y="834">[</text>
<text x="74" y="834">A</text>
<text x="84" y="834">=</text>
<text x="94" y="834">1</text>
<text x="104" y="834">0</text>
<text x="114" y="834">0</text>
<text x="124" y="834">0</text>
<text x="134" y="834">,</text>
<text x="154" y="834">B</text>
<text x="164" y="834">=</text>
<text x="174" y="834">5</text>
<text x="184" y="834">0</text>
<text x="194" y="834">0</text>
<text x="204" y="834">]</text>
<text x="744" y="834">│</text>
<text x="34" y="854">│</text>
<text x="104" y="854">↓</text>
<text x="124" y="854">扣</text>
<text x="144" y="854">款</text>
<text x="174" y="854">A</text>
<text x="744" y="854">│</text>
<text x="34" y="874">│</text>
<text x="64" y="874">[</text>
<text x="74" y="874">A</text>
<text x="84" y="874">=</text>
<text x="94" y="874">9</text>
<text x="104" y="874">0</text>
<text x="114" y="874">0</text>
<text x="124" y="874">,</text>
<text x="154" y="874">B</text>
<text x="164" y="874">=</text>
<text x="174" y="874">5</text>
<text x="184" y="874">0</text>
<text x="194" y="874">0</text>
<text x="204" y="874">]</text>
<text x="234" y="874">←</text>
<text x="254" y="874">此</text>
<text x="274" y="874">刻</text>
<text x="294" y="874">系</text>
<text x="314" y="874">統</text>
<text x="334" y="874">崩</text>
<text x="354" y="874">潰</text>
<text x="374" y="874">，</text>
<text x="394" y="874">$</text>
<text x="404" y="874">1</text>
<text x="414" y="874">0</text>
<text x="424" y="874">0</text>
<text x="444" y="874">憑</text>
<text x="464" y="874">空</text>
<text x="484" y="874">消</text>
<text x="504" y="874">失</text>
<text x="524" y="874">！</text>
<text x="744" y="874">│</text>
<text x="34" y="894">└</text>
<text x="44" y="894">─</text>
<text x="54" y="894">─</text>
<text x="64" y="894">─</text>
<text x="74" y="894">─</text>
<text x="84" y="894">─</text>
<text x="94" y="894">─</text>
<text x="104" y="894">─</text>
<text x="114" y="894">─</text>
<text x="124" y="894">─</text>
<text x="134" y="894">─</text>
<text x="144" y="894">─</text>
<text x="154" y="894">─</text>
<text x="164" y="894">─</text>
<text x="174" y="894">─</text>
<text x="184" y="894">─</text>
<text x="194" y="894">─</text>
<text x="204" y="894">─</text>
<text x="214" y="894">─</text>
<text x="224" y="894">─</text>
<text x="234" y="894">─</text>
<text x="244" y="894">─</text>
<text x="254" y="894">─</text>
<text x="264" y="894">─</text>
<text x="274" y="894">─</text>
<text x="284" y="894">─</text>
<text x="294" y="894">─</text>
<text x="304" y="894">─</text>
<text x="314" y="894">─</text>
<text x="324" y="894">─</text>
<text x="334" y="894">─</text>
<text x="344" y="894">─</text>
<text x="354" y="894">─</text>
<text x="364" y="894">─</text>
<text x="374" y="894">─</text>
<text x="384" y="894">─</text>
<text x="394" y="894">─</text>
<text x="404" y="894">─</text>
<text x="414" y="894">─</text>
<text x="424" y="894">─</text>
<text x="434" y="894">─</text>
<text x="444" y="894">─</text>
<text x="454" y="894">─</text>
<text x="464" y="894">─</text>
<text x="474" y="894">─</text>
<text x="484" y="894">─</text>
<text x="494" y="894">─</text>
<text x="504" y="894">─</text>
<text x="514" y="894">─</text>
<text x="524" y="894">─</text>
<text x="534" y="894">─</text>
<text x="544" y="894">─</text>
<text x="554" y="894">─</text>
<text x="564" y="894">─</text>
<text x="574" y="894">─</text>
<text x="584" y="894">─</text>
<text x="594" y="894">─</text>
<text x="604" y="894">─</text>
<text x="614" y="894">─</text>
<text x="624" y="894">─</text>
<text x="634" y="894">─</text>
<text x="644" y="894">─</text>
<text x="654" y="894">─</text>
<text x="664" y="894">─</text>
<text x="674" y="894">─</text>
<text x="684" y="894">─</text>
<text x="694" y="894">─</text>
<text x="704" y="894">─</text>
<text x="714" y="894">─</text>
<text x="724" y="894">─</text>
<text x="734" y="894">─</text>
<text x="744" y="894">┘</text>
</g>
</svg>
</div>
<p>一個操作不可被拆開觀察，要嘛全成，要嘛全不成。</p>
<h2 id="52-cpu-如何做原子對應-521523"><a class="header" href="#52-cpu-如何做原子對應-521523">5.2 CPU 如何做原子（對應 5.2.1~5.2.3）</a></h2>
<!-- subsection-diagram -->
<h3 id="本小節示意圖-1"><a class="header" href="#本小節示意圖-1">本小節示意圖</a></h3>
<div class="ascii-svg-wrap">
<svg class="ascii-svg" xmlns="http://www.w3.org/2000/svg" width="868" height="1224" viewBox="0 0 868 1224" role="img" aria-label="ASCII diagram">
<g fill="currentColor" font-family="Noto Sans Mono CJK TC, Noto Sans Mono CJK SC, Noto Sans Mono CJK JP, Sarasa Mono TC, Cascadia Mono, JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, monospace" font-size="16" text-rendering="geometricPrecision" xml:space="preserve">
<text x="14" y="14">C</text>
<text x="24" y="14">P</text>
<text x="34" y="14">U</text>
<text x="54" y="14">實</text>
<text x="74" y="14">現</text>
<text x="94" y="14">原</text>
<text x="114" y="14">子</text>
<text x="134" y="14">操</text>
<text x="154" y="14">作</text>
<text x="174" y="14">的</text>
<text x="194" y="14">三</text>
<text x="214" y="14">種</text>
<text x="234" y="14">方</text>
<text x="254" y="14">式</text>
<text x="274" y="14">：</text>
<text x="14" y="54">┌</text>
<text x="24" y="54">─</text>
<text x="34" y="54">─</text>
<text x="44" y="54">─</text>
<text x="54" y="54">─</text>
<text x="64" y="54">─</text>
<text x="74" y="54">─</text>
<text x="84" y="54">─</text>
<text x="94" y="54">─</text>
<text x="104" y="54">─</text>
<text x="114" y="54">─</text>
<text x="124" y="54">─</text>
<text x="134" y="54">─</text>
<text x="144" y="54">─</text>
<text x="154" y="54">─</text>
<text x="164" y="54">─</text>
<text x="174" y="54">─</text>
<text x="184" y="54">─</text>
<text x="194" y="54">─</text>
<text x="204" y="54">─</text>
<text x="214" y="54">─</text>
<text x="224" y="54">─</text>
<text x="234" y="54">─</text>
<text x="244" y="54">─</text>
<text x="254" y="54">─</text>
<text x="264" y="54">─</text>
<text x="274" y="54">─</text>
<text x="284" y="54">─</text>
<text x="294" y="54">─</text>
<text x="304" y="54">─</text>
<text x="314" y="54">─</text>
<text x="324" y="54">─</text>
<text x="334" y="54">─</text>
<text x="344" y="54">─</text>
<text x="354" y="54">─</text>
<text x="364" y="54">─</text>
<text x="374" y="54">─</text>
<text x="384" y="54">─</text>
<text x="394" y="54">─</text>
<text x="404" y="54">─</text>
<text x="414" y="54">─</text>
<text x="424" y="54">─</text>
<text x="434" y="54">─</text>
<text x="444" y="54">─</text>
<text x="454" y="54">─</text>
<text x="464" y="54">─</text>
<text x="474" y="54">─</text>
<text x="484" y="54">─</text>
<text x="494" y="54">─</text>
<text x="504" y="54">─</text>
<text x="514" y="54">─</text>
<text x="524" y="54">─</text>
<text x="534" y="54">─</text>
<text x="544" y="54">─</text>
<text x="554" y="54">─</text>
<text x="564" y="54">─</text>
<text x="574" y="54">─</text>
<text x="584" y="54">─</text>
<text x="594" y="54">─</text>
<text x="604" y="54">─</text>
<text x="614" y="54">─</text>
<text x="624" y="54">─</text>
<text x="634" y="54">─</text>
<text x="644" y="54">─</text>
<text x="654" y="54">─</text>
<text x="664" y="54">─</text>
<text x="674" y="54">─</text>
<text x="684" y="54">─</text>
<text x="694" y="54">─</text>
<text x="704" y="54">─</text>
<text x="714" y="54">─</text>
<text x="724" y="54">─</text>
<text x="734" y="54">─</text>
<text x="744" y="54">─</text>
<text x="754" y="54">─</text>
<text x="764" y="54">─</text>
<text x="774" y="54">─</text>
<text x="784" y="54">─</text>
<text x="794" y="54">─</text>
<text x="804" y="54">─</text>
<text x="814" y="54">─</text>
<text x="824" y="54">─</text>
<text x="834" y="54">─</text>
<text x="844" y="54">┐</text>
<text x="14" y="74">│</text>
<text x="44" y="74">方</text>
<text x="64" y="74">式</text>
<text x="94" y="74">1</text>
<text x="104" y="74">：</text>
<text x="124" y="74">總</text>
<text x="144" y="74">線</text>
<text x="164" y="74">鎖</text>
<text x="184" y="74">（</text>
<text x="204" y="74">B</text>
<text x="214" y="74">u</text>
<text x="224" y="74">s</text>
<text x="244" y="74">L</text>
<text x="254" y="74">o</text>
<text x="264" y="74">c</text>
<text x="274" y="74">k</text>
<text x="284" y="74">）</text>
<text x="304" y="74">—</text>
<text x="314" y="74">—</text>
<text x="334" y="74">老</text>
<text x="354" y="74">方</text>
<text x="374" y="74">法</text>
<text x="394" y="74">，</text>
<text x="414" y="74">代</text>
<text x="434" y="74">價</text>
<text x="454" y="74">高</text>
<text x="844" y="74">│</text>
<text x="64" y="94">│</text>
<text x="844" y="94">│</text>
<text x="14" y="114">│</text>
<text x="44" y="114">C</text>
<text x="54" y="114">P</text>
<text x="64" y="114">U</text>
<text x="74" y="114">0</text>
<text x="114" y="114">C</text>
<text x="124" y="114">P</text>
<text x="134" y="114">U</text>
<text x="144" y="114">1</text>
<text x="184" y="114">C</text>
<text x="194" y="114">P</text>
<text x="204" y="114">U</text>
<text x="214" y="114">2</text>
<text x="254" y="114">C</text>
<text x="264" y="114">P</text>
<text x="274" y="114">U</text>
<text x="284" y="114">3</text>
<text x="844" y="114">│</text>
<text x="64" y="134">│</text>
<text x="104" y="134">│</text>
<text x="174" y="134">│</text>
<text x="244" y="134">│</text>
<text x="314" y="134">│</text>
<text x="844" y="134">│</text>
<text x="14" y="154">│</text>
<text x="54" y="154">└</text>
<text x="64" y="154">─</text>
<text x="74" y="154">─</text>
<text x="84" y="154">─</text>
<text x="94" y="154">─</text>
<text x="104" y="154">─</text>
<text x="114" y="154">─</text>
<text x="124" y="154">┴</text>
<text x="134" y="154">─</text>
<text x="144" y="154">─</text>
<text x="154" y="154">─</text>
<text x="164" y="154">─</text>
<text x="174" y="154">─</text>
<text x="184" y="154">─</text>
<text x="194" y="154">┴</text>
<text x="204" y="154">─</text>
<text x="214" y="154">─</text>
<text x="224" y="154">─</text>
<text x="234" y="154">─</text>
<text x="244" y="154">─</text>
<text x="254" y="154">─</text>
<text x="264" y="154">─</text>
<text x="274" y="154">─</text>
<text x="284" y="154">─</text>
<text x="294" y="154">─</text>
<text x="304" y="154">─</text>
<text x="314" y="154">┘</text>
<text x="844" y="154">│</text>
<text x="64" y="174">│</text>
<text x="214" y="174">│</text>
<text x="844" y="174">│</text>
<text x="14" y="194">│</text>
<text x="114" y="194">系</text>
<text x="134" y="194">統</text>
<text x="154" y="194">匯</text>
<text x="174" y="194">流</text>
<text x="194" y="194">排</text>
<text x="214" y="194">（</text>
<text x="234" y="194">B</text>
<text x="244" y="194">u</text>
<text x="254" y="194">s</text>
<text x="264" y="194">）</text>
<text x="844" y="194">│</text>
<text x="64" y="214">│</text>
<text x="214" y="214">│</text>
<text x="844" y="214">│</text>
<text x="14" y="234">│</text>
<text x="134" y="234">記</text>
<text x="154" y="234">憶</text>
<text x="174" y="234">體</text>
<text x="194" y="234">（</text>
<text x="214" y="234">R</text>
<text x="224" y="234">A</text>
<text x="234" y="234">M</text>
<text x="244" y="234">）</text>
<text x="844" y="234">│</text>
<text x="64" y="254">│</text>
<text x="844" y="254">│</text>
<text x="14" y="274">│</text>
<text x="44" y="274">C</text>
<text x="54" y="274">P</text>
<text x="64" y="274">U</text>
<text x="74" y="274">0</text>
<text x="94" y="274">執</text>
<text x="114" y="274">行</text>
<text x="144" y="274">L</text>
<text x="154" y="274">O</text>
<text x="164" y="274">C</text>
<text x="174" y="274">K</text>
<text x="194" y="274">指</text>
<text x="214" y="274">令</text>
<text x="234" y="274">時</text>
<text x="254" y="274">：</text>
<text x="844" y="274">│</text>
<text x="14" y="294">│</text>
<text x="44" y="294">①</text>
<text x="64" y="294">拉</text>
<text x="84" y="294">低</text>
<text x="114" y="294">L</text>
<text x="124" y="294">O</text>
<text x="134" y="294">C</text>
<text x="144" y="294">K</text>
<text x="154" y="294">#</text>
<text x="174" y="294">信</text>
<text x="194" y="294">號</text>
<text x="214" y="294">線</text>
<text x="234" y="294">，</text>
<text x="254" y="294">獨</text>
<text x="274" y="294">占</text>
<text x="294" y="294">整</text>
<text x="314" y="294">條</text>
<text x="334" y="294">匯</text>
<text x="354" y="294">流</text>
<text x="374" y="294">排</text>
<text x="844" y="294">│</text>
<text x="14" y="314">│</text>
<text x="44" y="314">②</text>
<text x="64" y="314">其</text>
<text x="84" y="314">他</text>
<text x="114" y="314">C</text>
<text x="124" y="314">P</text>
<text x="134" y="314">U</text>
<text x="154" y="314">的</text>
<text x="174" y="314">記</text>
<text x="194" y="314">憶</text>
<text x="214" y="314">體</text>
<text x="234" y="314">存</text>
<text x="254" y="314">取</text>
<text x="274" y="314">全</text>
<text x="294" y="314">部</text>
<text x="314" y="314">被</text>
<text x="334" y="314">阻</text>
<text x="354" y="314">塞</text>
<text x="844" y="314">│</text>
<text x="14" y="334">│</text>
<text x="44" y="334">③</text>
<text x="64" y="334">完</text>
<text x="84" y="334">成</text>
<text x="104" y="334">操</text>
<text x="124" y="334">作</text>
<text x="144" y="334">後</text>
<text x="164" y="334">釋</text>
<text x="184" y="334">放</text>
<text x="214" y="334">L</text>
<text x="224" y="334">O</text>
<text x="234" y="334">C</text>
<text x="244" y="334">K</text>
<text x="254" y="334">#</text>
<text x="274" y="334">信</text>
<text x="294" y="334">號</text>
<text x="314" y="334">線</text>
<text x="844" y="334">│</text>
<text x="64" y="354">│</text>
<text x="844" y="354">│</text>
<text x="14" y="374">│</text>
<text x="44" y="374">缺</text>
<text x="64" y="374">點</text>
<text x="84" y="374">：</text>
<text x="104" y="374">鎖</text>
<text x="124" y="374">住</text>
<text x="144" y="374">整</text>
<text x="164" y="374">條</text>
<text x="184" y="374">匯</text>
<text x="204" y="374">流</text>
<text x="224" y="374">排</text>
<text x="244" y="374">，</text>
<text x="264" y="374">其</text>
<text x="284" y="374">他</text>
<text x="304" y="374">無</text>
<text x="324" y="374">關</text>
<text x="344" y="374">的</text>
<text x="364" y="374">記</text>
<text x="384" y="374">憶</text>
<text x="404" y="374">體</text>
<text x="424" y="374">操</text>
<text x="444" y="374">作</text>
<text x="464" y="374">也</text>
<text x="484" y="374">被</text>
<text x="504" y="374">阻</text>
<text x="524" y="374">塞</text>
<text x="544" y="374">，</text>
<text x="564" y="374">性</text>
<text x="584" y="374">能</text>
<text x="604" y="374">差</text>
<text x="844" y="374">│</text>
<text x="14" y="394">└</text>
<text x="24" y="394">─</text>
<text x="34" y="394">─</text>
<text x="44" y="394">─</text>
<text x="54" y="394">─</text>
<text x="64" y="394">─</text>
<text x="74" y="394">─</text>
<text x="84" y="394">─</text>
<text x="94" y="394">─</text>
<text x="104" y="394">─</text>
<text x="114" y="394">─</text>
<text x="124" y="394">─</text>
<text x="134" y="394">─</text>
<text x="144" y="394">─</text>
<text x="154" y="394">─</text>
<text x="164" y="394">─</text>
<text x="174" y="394">─</text>
<text x="184" y="394">─</text>
<text x="194" y="394">─</text>
<text x="204" y="394">─</text>
<text x="214" y="394">─</text>
<text x="224" y="394">─</text>
<text x="234" y="394">─</text>
<text x="244" y="394">─</text>
<text x="254" y="394">─</text>
<text x="264" y="394">─</text>
<text x="274" y="394">─</text>
<text x="284" y="394">─</text>
<text x="294" y="394">─</text>
<text x="304" y="394">─</text>
<text x="314" y="394">─</text>
<text x="324" y="394">─</text>
<text x="334" y="394">─</text>
<text x="344" y="394">─</text>
<text x="354" y="394">─</text>
<text x="364" y="394">─</text>
<text x="374" y="394">─</text>
<text x="384" y="394">─</text>
<text x="394" y="394">─</text>
<text x="404" y="394">─</text>
<text x="414" y="394">─</text>
<text x="424" y="394">─</text>
<text x="434" y="394">─</text>
<text x="444" y="394">─</text>
<text x="454" y="394">─</text>
<text x="464" y="394">─</text>
<text x="474" y="394">─</text>
<text x="484" y="394">─</text>
<text x="494" y="394">─</text>
<text x="504" y="394">─</text>
<text x="514" y="394">─</text>
<text x="524" y="394">─</text>
<text x="534" y="394">─</text>
<text x="544" y="394">─</text>
<text x="554" y="394">─</text>
<text x="564" y="394">─</text>
<text x="574" y="394">─</text>
<text x="584" y="394">─</text>
<text x="594" y="394">─</text>
<text x="604" y="394">─</text>
<text x="614" y="394">─</text>
<text x="624" y="394">─</text>
<text x="634" y="394">─</text>
<text x="644" y="394">─</text>
<text x="654" y="394">─</text>
<text x="664" y="394">─</text>
<text x="674" y="394">─</text>
<text x="684" y="394">─</text>
<text x="694" y="394">─</text>
<text x="704" y="394">─</text>
<text x="714" y="394">─</text>
<text x="724" y="394">─</text>
<text x="734" y="394">─</text>
<text x="744" y="394">─</text>
<text x="754" y="394">─</text>
<text x="764" y="394">─</text>
<text x="774" y="394">─</text>
<text x="784" y="394">─</text>
<text x="794" y="394">─</text>
<text x="804" y="394">─</text>
<text x="814" y="394">─</text>
<text x="824" y="394">─</text>
<text x="834" y="394">─</text>
<text x="844" y="394">┘</text>
<text x="14" y="434">┌</text>
<text x="24" y="434">─</text>
<text x="34" y="434">─</text>
<text x="44" y="434">─</text>
<text x="54" y="434">─</text>
<text x="64" y="434">─</text>
<text x="74" y="434">─</text>
<text x="84" y="434">─</text>
<text x="94" y="434">─</text>
<text x="104" y="434">─</text>
<text x="114" y="434">─</text>
<text x="124" y="434">─</text>
<text x="134" y="434">─</text>
<text x="144" y="434">─</text>
<text x="154" y="434">─</text>
<text x="164" y="434">─</text>
<text x="174" y="434">─</text>
<text x="184" y="434">─</text>
<text x="194" y="434">─</text>
<text x="204" y="434">─</text>
<text x="214" y="434">─</text>
<text x="224" y="434">─</text>
<text x="234" y="434">─</text>
<text x="244" y="434">─</text>
<text x="254" y="434">─</text>
<text x="264" y="434">─</text>
<text x="274" y="434">─</text>
<text x="284" y="434">─</text>
<text x="294" y="434">─</text>
<text x="304" y="434">─</text>
<text x="314" y="434">─</text>
<text x="324" y="434">─</text>
<text x="334" y="434">─</text>
<text x="344" y="434">─</text>
<text x="354" y="434">─</text>
<text x="364" y="434">─</text>
<text x="374" y="434">─</text>
<text x="384" y="434">─</text>
<text x="394" y="434">─</text>
<text x="404" y="434">─</text>
<text x="414" y="434">─</text>
<text x="424" y="434">─</text>
<text x="434" y="434">─</text>
<text x="444" y="434">─</text>
<text x="454" y="434">─</text>
<text x="464" y="434">─</text>
<text x="474" y="434">─</text>
<text x="484" y="434">─</text>
<text x="494" y="434">─</text>
<text x="504" y="434">─</text>
<text x="514" y="434">─</text>
<text x="524" y="434">─</text>
<text x="534" y="434">─</text>
<text x="544" y="434">─</text>
<text x="554" y="434">─</text>
<text x="564" y="434">─</text>
<text x="574" y="434">─</text>
<text x="584" y="434">─</text>
<text x="594" y="434">─</text>
<text x="604" y="434">─</text>
<text x="614" y="434">─</text>
<text x="624" y="434">─</text>
<text x="634" y="434">─</text>
<text x="644" y="434">─</text>
<text x="654" y="434">─</text>
<text x="664" y="434">─</text>
<text x="674" y="434">─</text>
<text x="684" y="434">─</text>
<text x="694" y="434">─</text>
<text x="704" y="434">─</text>
<text x="714" y="434">─</text>
<text x="724" y="434">─</text>
<text x="734" y="434">─</text>
<text x="744" y="434">─</text>
<text x="754" y="434">─</text>
<text x="764" y="434">─</text>
<text x="774" y="434">─</text>
<text x="784" y="434">─</text>
<text x="794" y="434">─</text>
<text x="804" y="434">─</text>
<text x="814" y="434">─</text>
<text x="824" y="434">─</text>
<text x="834" y="434">─</text>
<text x="844" y="434">┐</text>
<text x="14" y="454">│</text>
<text x="44" y="454">方</text>
<text x="64" y="454">式</text>
<text x="94" y="454">2</text>
<text x="104" y="454">：</text>
<text x="124" y="454">快</text>
<text x="144" y="454">取</text>
<text x="164" y="454">鎖</text>
<text x="184" y="454">（</text>
<text x="204" y="454">C</text>
<text x="214" y="454">a</text>
<text x="224" y="454">c</text>
<text x="234" y="454">h</text>
<text x="244" y="454">e</text>
<text x="264" y="454">L</text>
<text x="274" y="454">o</text>
<text x="284" y="454">c</text>
<text x="294" y="454">k</text>
<text x="304" y="454">）</text>
<text x="324" y="454">+</text>
<text x="344" y="454">M</text>
<text x="354" y="454">E</text>
<text x="364" y="454">S</text>
<text x="374" y="454">I</text>
<text x="394" y="454">協</text>
<text x="414" y="454">議</text>
<text x="444" y="454">—</text>
<text x="454" y="454">—</text>
<text x="474" y="454">現</text>
<text x="494" y="454">代</text>
<text x="514" y="454">主</text>
<text x="534" y="454">流</text>
<text x="844" y="454">│</text>
<text x="64" y="474">│</text>
<text x="844" y="474">│</text>
<text x="14" y="494">│</text>
<text x="44" y="494">┌</text>
<text x="54" y="494">─</text>
<text x="64" y="494">─</text>
<text x="74" y="494">─</text>
<text x="84" y="494">─</text>
<text x="94" y="494">─</text>
<text x="104" y="494">─</text>
<text x="114" y="494">─</text>
<text x="124" y="494">─</text>
<text x="134" y="494">─</text>
<text x="144" y="494">─</text>
<text x="154" y="494">─</text>
<text x="164" y="494">─</text>
<text x="174" y="494">─</text>
<text x="184" y="494">─</text>
<text x="194" y="494">─</text>
<text x="204" y="494">─</text>
<text x="214" y="494">─</text>
<text x="224" y="494">─</text>
<text x="234" y="494">┐</text>
<text x="294" y="494">┌</text>
<text x="304" y="494">─</text>
<text x="314" y="494">─</text>
<text x="324" y="494">─</text>
<text x="334" y="494">─</text>
<text x="344" y="494">─</text>
<text x="354" y="494">─</text>
<text x="364" y="494">─</text>
<text x="374" y="494">─</text>
<text x="384" y="494">─</text>
<text x="394" y="494">─</text>
<text x="404" y="494">─</text>
<text x="414" y="494">─</text>
<text x="424" y="494">─</text>
<text x="434" y="494">─</text>
<text x="444" y="494">─</text>
<text x="454" y="494">─</text>
<text x="464" y="494">─</text>
<text x="474" y="494">─</text>
<text x="484" y="494">─</text>
<text x="494" y="494">─</text>
<text x="504" y="494">─</text>
<text x="514" y="494">─</text>
<text x="524" y="494">─</text>
<text x="534" y="494">─</text>
<text x="544" y="494">┐</text>
<text x="844" y="494">│</text>
<text x="14" y="514">│</text>
<text x="44" y="514">│</text>
<text x="114" y="514">C</text>
<text x="124" y="514">P</text>
<text x="134" y="514">U</text>
<text x="144" y="514">0</text>
<text x="234" y="514">│</text>
<text x="294" y="514">│</text>
<text x="364" y="514">C</text>
<text x="374" y="514">P</text>
<text x="384" y="514">U</text>
<text x="394" y="514">1</text>
<text x="544" y="514">│</text>
<text x="844" y="514">│</text>
<text x="14" y="534">│</text>
<text x="44" y="534">│</text>
<text x="74" y="534">┌</text>
<text x="84" y="534">─</text>
<text x="94" y="534">─</text>
<text x="104" y="534">─</text>
<text x="114" y="534">─</text>
<text x="124" y="534">─</text>
<text x="134" y="534">─</text>
<text x="144" y="534">─</text>
<text x="154" y="534">─</text>
<text x="164" y="534">─</text>
<text x="174" y="534">─</text>
<text x="184" y="534">─</text>
<text x="194" y="534">─</text>
<text x="204" y="534">┐</text>
<text x="234" y="534">│</text>
<text x="294" y="534">│</text>
<text x="324" y="534">┌</text>
<text x="334" y="534">─</text>
<text x="344" y="534">─</text>
<text x="354" y="534">─</text>
<text x="364" y="534">─</text>
<text x="374" y="534">─</text>
<text x="384" y="534">─</text>
<text x="394" y="534">─</text>
<text x="404" y="534">─</text>
<text x="414" y="534">─</text>
<text x="424" y="534">─</text>
<text x="434" y="534">─</text>
<text x="444" y="534">─</text>
<text x="454" y="534">─</text>
<text x="464" y="534">─</text>
<text x="474" y="534">─</text>
<text x="484" y="534">─</text>
<text x="494" y="534">─</text>
<text x="504" y="534">─</text>
<text x="514" y="534">┐</text>
<text x="544" y="534">│</text>
<text x="844" y="534">│</text>
<text x="14" y="554">│</text>
<text x="44" y="554">│</text>
<text x="74" y="554">│</text>
<text x="94" y="554">L</text>
<text x="104" y="554">1</text>
<text x="124" y="554">C</text>
<text x="134" y="554">a</text>
<text x="144" y="554">c</text>
<text x="154" y="554">h</text>
<text x="164" y="554">e</text>
<text x="204" y="554">│</text>
<text x="234" y="554">│</text>
<text x="294" y="554">│</text>
<text x="324" y="554">│</text>
<text x="344" y="554">L</text>
<text x="354" y="554">1</text>
<text x="374" y="554">C</text>
<text x="384" y="554">a</text>
<text x="394" y="554">c</text>
<text x="404" y="554">h</text>
<text x="414" y="554">e</text>
<text x="514" y="554">│</text>
<text x="544" y="554">│</text>
<text x="844" y="554">│</text>
<text x="14" y="574">│</text>
<text x="44" y="574">│</text>
<text x="74" y="574">│</text>
<text x="94" y="574">[</text>
<text x="104" y="574">x</text>
<text x="114" y="574">]</text>
<text x="134" y="574">M</text>
<text x="154" y="574">─</text>
<text x="164" y="574">─</text>
<text x="174" y="574">─</text>
<text x="184" y="574">─</text>
<text x="194" y="574">─</text>
<text x="204" y="574">┼</text>
<text x="214" y="574">─</text>
<text x="224" y="574">─</text>
<text x="234" y="574">┼</text>
<text x="244" y="574">─</text>
<text x="254" y="574">─</text>
<text x="264" y="574">─</text>
<text x="274" y="574">─</text>
<text x="284" y="574">─</text>
<text x="294" y="574">┼</text>
<text x="304" y="574">─</text>
<text x="314" y="574">─</text>
<text x="324" y="574">┼</text>
<text x="334" y="574">─</text>
<text x="344" y="574">[</text>
<text x="354" y="574">x</text>
<text x="364" y="574">]</text>
<text x="384" y="574">I</text>
<text x="444" y="574">│</text>
<text x="474" y="574">│</text>
<text x="504" y="574">M</text>
<text x="514" y="574">=</text>
<text x="524" y="574">M</text>
<text x="534" y="574">o</text>
<text x="544" y="574">d</text>
<text x="554" y="574">i</text>
<text x="564" y="574">f</text>
<text x="574" y="574">i</text>
<text x="584" y="574">e</text>
<text x="594" y="574">d</text>
<text x="604" y="574">,</text>
<text x="624" y="574">I</text>
<text x="634" y="574">=</text>
<text x="644" y="574">I</text>
<text x="654" y="574">n</text>
<text x="664" y="574">v</text>
<text x="674" y="574">a</text>
<text x="684" y="574">l</text>
<text x="694" y="574">i</text>
<text x="704" y="574">d</text>
<text x="844" y="574">│</text>
<text x="14" y="594">│</text>
<text x="44" y="594">│</text>
<text x="74" y="594">└</text>
<text x="84" y="594">─</text>
<text x="94" y="594">─</text>
<text x="104" y="594">─</text>
<text x="114" y="594">─</text>
<text x="124" y="594">─</text>
<text x="134" y="594">─</text>
<text x="144" y="594">─</text>
<text x="154" y="594">─</text>
<text x="164" y="594">─</text>
<text x="174" y="594">─</text>
<text x="184" y="594">─</text>
<text x="194" y="594">─</text>
<text x="204" y="594">┘</text>
<text x="234" y="594">│</text>
<text x="294" y="594">│</text>
<text x="324" y="594">└</text>
<text x="334" y="594">─</text>
<text x="344" y="594">─</text>
<text x="354" y="594">─</text>
<text x="364" y="594">─</text>
<text x="374" y="594">─</text>
<text x="384" y="594">─</text>
<text x="394" y="594">─</text>
<text x="404" y="594">─</text>
<text x="414" y="594">─</text>
<text x="424" y="594">─</text>
<text x="434" y="594">─</text>
<text x="444" y="594">─</text>
<text x="454" y="594">─</text>
<text x="464" y="594">─</text>
<text x="474" y="594">─</text>
<text x="484" y="594">─</text>
<text x="494" y="594">─</text>
<text x="504" y="594">─</text>
<text x="514" y="594">┘</text>
<text x="544" y="594">│</text>
<text x="844" y="594">│</text>
<text x="14" y="614">│</text>
<text x="44" y="614">└</text>
<text x="54" y="614">─</text>
<text x="64" y="614">─</text>
<text x="74" y="614">─</text>
<text x="84" y="614">─</text>
<text x="94" y="614">─</text>
<text x="104" y="614">─</text>
<text x="114" y="614">─</text>
<text x="124" y="614">─</text>
<text x="134" y="614">─</text>
<text x="144" y="614">─</text>
<text x="154" y="614">─</text>
<text x="164" y="614">─</text>
<text x="174" y="614">─</text>
<text x="184" y="614">─</text>
<text x="194" y="614">─</text>
<text x="204" y="614">─</text>
<text x="214" y="614">─</text>
<text x="224" y="614">─</text>
<text x="234" y="614">┘</text>
<text x="294" y="614">└</text>
<text x="304" y="614">─</text>
<text x="314" y="614">─</text>
<text x="324" y="614">─</text>
<text x="334" y="614">─</text>
<text x="344" y="614">─</text>
<text x="354" y="614">─</text>
<text x="364" y="614">─</text>
<text x="374" y="614">─</text>
<text x="384" y="614">─</text>
<text x="394" y="614">─</text>
<text x="404" y="614">─</text>
<text x="414" y="614">─</text>
<text x="424" y="614">─</text>
<text x="434" y="614">─</text>
<text x="444" y="614">─</text>
<text x="454" y="614">─</text>
<text x="464" y="614">─</text>
<text x="474" y="614">─</text>
<text x="484" y="614">─</text>
<text x="494" y="614">─</text>
<text x="504" y="614">─</text>
<text x="514" y="614">─</text>
<text x="524" y="614">─</text>
<text x="534" y="614">─</text>
<text x="544" y="614">┘</text>
<text x="844" y="614">│</text>
<text x="64" y="634">│</text>
<text x="844" y="634">│</text>
<text x="14" y="654">│</text>
<text x="44" y="654">C</text>
<text x="54" y="654">P</text>
<text x="64" y="654">U</text>
<text x="74" y="654">0</text>
<text x="94" y="654">對</text>
<text x="124" y="654">x</text>
<text x="144" y="654">做</text>
<text x="164" y="654">原</text>
<text x="184" y="654">子</text>
<text x="204" y="654">操</text>
<text x="224" y="654">作</text>
<text x="244" y="654">時</text>
<text x="264" y="654">：</text>
<text x="844" y="654">│</text>
<text x="14" y="674">│</text>
<text x="44" y="674">①</text>
<text x="64" y="674">C</text>
<text x="74" y="674">P</text>
<text x="84" y="674">U</text>
<text x="94" y="674">0</text>
<text x="114" y="674">將</text>
<text x="144" y="674">x</text>
<text x="164" y="674">所</text>
<text x="184" y="674">在</text>
<text x="204" y="674">的</text>
<text x="224" y="674">快</text>
<text x="244" y="674">取</text>
<text x="264" y="674">行</text>
<text x="284" y="674">標</text>
<text x="304" y="674">記</text>
<text x="324" y="674">為</text>
<text x="354" y="674">M</text>
<text x="364" y="674">o</text>
<text x="374" y="674">d</text>
<text x="384" y="674">i</text>
<text x="394" y="674">f</text>
<text x="404" y="674">i</text>
<text x="414" y="674">e</text>
<text x="424" y="674">d</text>
<text x="434" y="674">（</text>
<text x="454" y="674">獨</text>
<text x="474" y="674">占</text>
<text x="494" y="674">修</text>
<text x="514" y="674">改</text>
<text x="534" y="674">）</text>
<text x="844" y="674">│</text>
<text x="14" y="694">│</text>
<text x="44" y="694">②</text>
<text x="64" y="694">通</text>
<text x="84" y="694">過</text>
<text x="114" y="694">M</text>
<text x="124" y="694">E</text>
<text x="134" y="694">S</text>
<text x="144" y="694">I</text>
<text x="164" y="694">協</text>
<text x="184" y="694">議</text>
<text x="204" y="694">，</text>
<text x="224" y="694">通</text>
<text x="244" y="694">知</text>
<text x="274" y="694">C</text>
<text x="284" y="694">P</text>
<text x="294" y="694">U</text>
<text x="304" y="694">1</text>
<text x="324" y="694">其</text>
<text x="344" y="694">快</text>
<text x="364" y="694">取</text>
<text x="384" y="694">行</text>
<text x="404" y="694">變</text>
<text x="424" y="694">為</text>
<text x="454" y="694">I</text>
<text x="464" y="694">n</text>
<text x="474" y="694">v</text>
<text x="484" y="694">a</text>
<text x="494" y="694">l</text>
<text x="504" y="694">i</text>
<text x="514" y="694">d</text>
<text x="524" y="694">（</text>
<text x="544" y="694">無</text>
<text x="564" y="694">效</text>
<text x="584" y="694">）</text>
<text x="844" y="694">│</text>
<text x="14" y="714">│</text>
<text x="44" y="714">③</text>
<text x="64" y="714">C</text>
<text x="74" y="714">P</text>
<text x="84" y="714">U</text>
<text x="94" y="714">0</text>
<text x="114" y="714">完</text>
<text x="134" y="714">成</text>
<text x="154" y="714">修</text>
<text x="174" y="714">改</text>
<text x="194" y="714">後</text>
<text x="214" y="714">，</text>
<text x="234" y="714">數</text>
<text x="254" y="714">據</text>
<text x="274" y="714">透</text>
<text x="294" y="714">過</text>
<text x="314" y="714">快</text>
<text x="334" y="714">取</text>
<text x="354" y="714">一</text>
<text x="374" y="714">致</text>
<text x="394" y="714">性</text>
<text x="414" y="714">協</text>
<text x="434" y="714">議</text>
<text x="454" y="714">同</text>
<text x="474" y="714">步</text>
<text x="844" y="714">│</text>
<text x="64" y="734">│</text>
<text x="844" y="734">│</text>
<text x="14" y="754">│</text>
<text x="44" y="754">優</text>
<text x="64" y="754">點</text>
<text x="84" y="754">：</text>
<text x="104" y="754">只</text>
<text x="124" y="754">鎖</text>
<text x="144" y="754">定</text>
<text x="164" y="754">快</text>
<text x="184" y="754">取</text>
<text x="204" y="754">行</text>
<text x="224" y="754">，</text>
<text x="244" y="754">不</text>
<text x="264" y="754">鎖</text>
<text x="284" y="754">整</text>
<text x="304" y="754">條</text>
<text x="324" y="754">匯</text>
<text x="344" y="754">流</text>
<text x="364" y="754">排</text>
<text x="384" y="754">，</text>
<text x="404" y="754">範</text>
<text x="424" y="754">圍</text>
<text x="444" y="754">更</text>
<text x="464" y="754">小</text>
<text x="484" y="754">、</text>
<text x="504" y="754">性</text>
<text x="524" y="754">能</text>
<text x="544" y="754">更</text>
<text x="564" y="754">好</text>
<text x="844" y="754">│</text>
<text x="14" y="774">│</text>
<text x="44" y="774">限</text>
<text x="64" y="774">制</text>
<text x="84" y="774">：</text>
<text x="104" y="774">跨</text>
<text x="124" y="774">快</text>
<text x="144" y="774">取</text>
<text x="164" y="774">行</text>
<text x="184" y="774">（</text>
<text x="204" y="774">C</text>
<text x="214" y="774">a</text>
<text x="224" y="774">c</text>
<text x="234" y="774">h</text>
<text x="244" y="774">e</text>
<text x="264" y="774">L</text>
<text x="274" y="774">i</text>
<text x="284" y="774">n</text>
<text x="294" y="774">e</text>
<text x="314" y="774">B</text>
<text x="324" y="774">o</text>
<text x="334" y="774">u</text>
<text x="344" y="774">n</text>
<text x="354" y="774">d</text>
<text x="364" y="774">a</text>
<text x="374" y="774">r</text>
<text x="384" y="774">y</text>
<text x="394" y="774">）</text>
<text x="414" y="774">的</text>
<text x="434" y="774">操</text>
<text x="454" y="774">作</text>
<text x="474" y="774">仍</text>
<text x="494" y="774">需</text>
<text x="514" y="774">要</text>
<text x="534" y="774">總</text>
<text x="554" y="774">線</text>
<text x="574" y="774">鎖</text>
<text x="844" y="774">│</text>
<text x="14" y="794">└</text>
<text x="24" y="794">─</text>
<text x="34" y="794">─</text>
<text x="44" y="794">─</text>
<text x="54" y="794">─</text>
<text x="64" y="794">─</text>
<text x="74" y="794">─</text>
<text x="84" y="794">─</text>
<text x="94" y="794">─</text>
<text x="104" y="794">─</text>
<text x="114" y="794">─</text>
<text x="124" y="794">─</text>
<text x="134" y="794">─</text>
<text x="144" y="794">─</text>
<text x="154" y="794">─</text>
<text x="164" y="794">─</text>
<text x="174" y="794">─</text>
<text x="184" y="794">─</text>
<text x="194" y="794">─</text>
<text x="204" y="794">─</text>
<text x="214" y="794">─</text>
<text x="224" y="794">─</text>
<text x="234" y="794">─</text>
<text x="244" y="794">─</text>
<text x="254" y="794">─</text>
<text x="264" y="794">─</text>
<text x="274" y="794">─</text>
<text x="284" y="794">─</text>
<text x="294" y="794">─</text>
<text x="304" y="794">─</text>
<text x="314" y="794">─</text>
<text x="324" y="794">─</text>
<text x="334" y="794">─</text>
<text x="344" y="794">─</text>
<text x="354" y="794">─</text>
<text x="364" y="794">─</text>
<text x="374" y="794">─</text>
<text x="384" y="794">─</text>
<text x="394" y="794">─</text>
<text x="404" y="794">─</text>
<text x="414" y="794">─</text>
<text x="424" y="794">─</text>
<text x="434" y="794">─</text>
<text x="444" y="794">─</text>
<text x="454" y="794">─</text>
<text x="464" y="794">─</text>
<text x="474" y="794">─</text>
<text x="484" y="794">─</text>
<text x="494" y="794">─</text>
<text x="504" y="794">─</text>
<text x="514" y="794">─</text>
<text x="524" y="794">─</text>
<text x="534" y="794">─</text>
<text x="544" y="794">─</text>
<text x="554" y="794">─</text>
<text x="564" y="794">─</text>
<text x="574" y="794">─</text>
<text x="584" y="794">─</text>
<text x="594" y="794">─</text>
<text x="604" y="794">─</text>
<text x="614" y="794">─</text>
<text x="624" y="794">─</text>
<text x="634" y="794">─</text>
<text x="644" y="794">─</text>
<text x="654" y="794">─</text>
<text x="664" y="794">─</text>
<text x="674" y="794">─</text>
<text x="684" y="794">─</text>
<text x="694" y="794">─</text>
<text x="704" y="794">─</text>
<text x="714" y="794">─</text>
<text x="724" y="794">─</text>
<text x="734" y="794">─</text>
<text x="744" y="794">─</text>
<text x="754" y="794">─</text>
<text x="764" y="794">─</text>
<text x="774" y="794">─</text>
<text x="784" y="794">─</text>
<text x="794" y="794">─</text>
<text x="804" y="794">─</text>
<text x="814" y="794">─</text>
<text x="824" y="794">─</text>
<text x="834" y="794">─</text>
<text x="844" y="794">┘</text>
<text x="14" y="834">┌</text>
<text x="24" y="834">─</text>
<text x="34" y="834">─</text>
<text x="44" y="834">─</text>
<text x="54" y="834">─</text>
<text x="64" y="834">─</text>
<text x="74" y="834">─</text>
<text x="84" y="834">─</text>
<text x="94" y="834">─</text>
<text x="104" y="834">─</text>
<text x="114" y="834">─</text>
<text x="124" y="834">─</text>
<text x="134" y="834">─</text>
<text x="144" y="834">─</text>
<text x="154" y="834">─</text>
<text x="164" y="834">─</text>
<text x="174" y="834">─</text>
<text x="184" y="834">─</text>
<text x="194" y="834">─</text>
<text x="204" y="834">─</text>
<text x="214" y="834">─</text>
<text x="224" y="834">─</text>
<text x="234" y="834">─</text>
<text x="244" y="834">─</text>
<text x="254" y="834">─</text>
<text x="264" y="834">─</text>
<text x="274" y="834">─</text>
<text x="284" y="834">─</text>
<text x="294" y="834">─</text>
<text x="304" y="834">─</text>
<text x="314" y="834">─</text>
<text x="324" y="834">─</text>
<text x="334" y="834">─</text>
<text x="344" y="834">─</text>
<text x="354" y="834">─</text>
<text x="364" y="834">─</text>
<text x="374" y="834">─</text>
<text x="384" y="834">─</text>
<text x="394" y="834">─</text>
<text x="404" y="834">─</text>
<text x="414" y="834">─</text>
<text x="424" y="834">─</text>
<text x="434" y="834">─</text>
<text x="444" y="834">─</text>
<text x="454" y="834">─</text>
<text x="464" y="834">─</text>
<text x="474" y="834">─</text>
<text x="484" y="834">─</text>
<text x="494" y="834">─</text>
<text x="504" y="834">─</text>
<text x="514" y="834">─</text>
<text x="524" y="834">─</text>
<text x="534" y="834">─</text>
<text x="544" y="834">─</text>
<text x="554" y="834">─</text>
<text x="564" y="834">─</text>
<text x="574" y="834">─</text>
<text x="584" y="834">─</text>
<text x="594" y="834">─</text>
<text x="604" y="834">─</text>
<text x="614" y="834">─</text>
<text x="624" y="834">─</text>
<text x="634" y="834">─</text>
<text x="644" y="834">─</text>
<text x="654" y="834">─</text>
<text x="664" y="834">─</text>
<text x="674" y="834">─</text>
<text x="684" y="834">─</text>
<text x="694" y="834">─</text>
<text x="704" y="834">─</text>
<text x="714" y="834">─</text>
<text x="724" y="834">─</text>
<text x="734" y="834">─</text>
<text x="744" y="834">─</text>
<text x="754" y="834">─</text>
<text x="764" y="834">─</text>
<text x="774" y="834">─</text>
<text x="784" y="834">─</text>
<text x="794" y="834">─</text>
<text x="804" y="834">─</text>
<text x="814" y="834">─</text>
<text x="824" y="834">─</text>
<text x="834" y="834">─</text>
<text x="844" y="834">┐</text>
<text x="14" y="854">│</text>
<text x="44" y="854">方</text>
<text x="64" y="854">式</text>
<text x="94" y="854">3</text>
<text x="104" y="854">：</text>
<text x="124" y="854">C</text>
<text x="134" y="854">A</text>
<text x="144" y="854">S</text>
<text x="164" y="854">指</text>
<text x="184" y="854">令</text>
<text x="204" y="854">（</text>
<text x="224" y="854">C</text>
<text x="234" y="854">o</text>
<text x="244" y="854">m</text>
<text x="254" y="854">p</text>
<text x="264" y="854">a</text>
<text x="274" y="854">r</text>
<text x="284" y="854">e</text>
<text x="294" y="854">-</text>
<text x="304" y="854">A</text>
<text x="314" y="854">n</text>
<text x="324" y="854">d</text>
<text x="334" y="854">-</text>
<text x="344" y="854">S</text>
<text x="354" y="854">w</text>
<text x="364" y="854">a</text>
<text x="374" y="854">p</text>
<text x="384" y="854">）</text>
<text x="404" y="854">—</text>
<text x="414" y="854">—</text>
<text x="434" y="854">無</text>
<text x="454" y="854">鎖</text>
<text x="474" y="854">演</text>
<text x="494" y="854">算</text>
<text x="514" y="854">法</text>
<text x="534" y="854">基</text>
<text x="554" y="854">石</text>
<text x="844" y="854">│</text>
<text x="64" y="874">│</text>
<text x="844" y="874">│</text>
<text x="14" y="894">│</text>
<text x="44" y="894">x</text>
<text x="54" y="894">8</text>
<text x="64" y="894">6</text>
<text x="84" y="894">指</text>
<text x="104" y="894">令</text>
<text x="124" y="894">：</text>
<text x="144" y="894">C</text>
<text x="154" y="894">M</text>
<text x="164" y="894">P</text>
<text x="174" y="894">X</text>
<text x="184" y="894">C</text>
<text x="194" y="894">H</text>
<text x="204" y="894">G</text>
<text x="214" y="894">（</text>
<text x="234" y="894">C</text>
<text x="244" y="894">o</text>
<text x="254" y="894">m</text>
<text x="264" y="894">p</text>
<text x="274" y="894">a</text>
<text x="284" y="894">r</text>
<text x="294" y="894">e</text>
<text x="314" y="894">a</text>
<text x="324" y="894">n</text>
<text x="334" y="894">d</text>
<text x="354" y="894">E</text>
<text x="364" y="894">x</text>
<text x="374" y="894">c</text>
<text x="384" y="894">h</text>
<text x="394" y="894">a</text>
<text x="404" y="894">n</text>
<text x="414" y="894">g</text>
<text x="424" y="894">e</text>
<text x="434" y="894">）</text>
<text x="844" y="894">│</text>
<text x="64" y="914">│</text>
<text x="844" y="914">│</text>
<text x="14" y="934">│</text>
<text x="44" y="934">偽</text>
<text x="64" y="934">代</text>
<text x="84" y="934">碼</text>
<text x="104" y="934">（</text>
<text x="124" y="934">原</text>
<text x="144" y="934">子</text>
<text x="164" y="934">執</text>
<text x="184" y="934">行</text>
<text x="204" y="934">，</text>
<text x="224" y="934">不</text>
<text x="244" y="934">可</text>
<text x="264" y="934">被</text>
<text x="284" y="934">中</text>
<text x="304" y="934">斷</text>
<text x="324" y="934">）</text>
<text x="344" y="934">：</text>
<text x="844" y="934">│</text>
<text x="14" y="954">│</text>
<text x="44" y="954">┌</text>
<text x="54" y="954">─</text>
<text x="64" y="954">─</text>
<text x="74" y="954">─</text>
<text x="84" y="954">─</text>
<text x="94" y="954">─</text>
<text x="104" y="954">─</text>
<text x="114" y="954">─</text>
<text x="124" y="954">─</text>
<text x="134" y="954">─</text>
<text x="144" y="954">─</text>
<text x="154" y="954">─</text>
<text x="164" y="954">─</text>
<text x="174" y="954">─</text>
<text x="184" y="954">─</text>
<text x="194" y="954">─</text>
<text x="204" y="954">─</text>
<text x="214" y="954">─</text>
<text x="224" y="954">─</text>
<text x="234" y="954">─</text>
<text x="244" y="954">─</text>
<text x="254" y="954">─</text>
<text x="264" y="954">─</text>
<text x="274" y="954">─</text>
<text x="284" y="954">─</text>
<text x="294" y="954">─</text>
<text x="304" y="954">─</text>
<text x="314" y="954">─</text>
<text x="324" y="954">─</text>
<text x="334" y="954">─</text>
<text x="344" y="954">─</text>
<text x="354" y="954">─</text>
<text x="364" y="954">─</text>
<text x="374" y="954">─</text>
<text x="384" y="954">─</text>
<text x="394" y="954">─</text>
<text x="404" y="954">─</text>
<text x="414" y="954">─</text>
<text x="424" y="954">─</text>
<text x="434" y="954">─</text>
<text x="444" y="954">─</text>
<text x="454" y="954">─</text>
<text x="464" y="954">─</text>
<text x="474" y="954">─</text>
<text x="484" y="954">─</text>
<text x="494" y="954">─</text>
<text x="504" y="954">─</text>
<text x="514" y="954">─</text>
<text x="524" y="954">─</text>
<text x="534" y="954">─</text>
<text x="544" y="954">─</text>
<text x="554" y="954">─</text>
<text x="564" y="954">─</text>
<text x="574" y="954">─</text>
<text x="584" y="954">─</text>
<text x="594" y="954">─</text>
<text x="604" y="954">─</text>
<text x="614" y="954">─</text>
<text x="624" y="954">─</text>
<text x="634" y="954">─</text>
<text x="644" y="954">─</text>
<text x="654" y="954">─</text>
<text x="664" y="954">─</text>
<text x="674" y="954">─</text>
<text x="684" y="954">┐</text>
<text x="844" y="954">│</text>
<text x="14" y="974">│</text>
<text x="44" y="974">│</text>
<text x="74" y="974">a</text>
<text x="84" y="974">t</text>
<text x="94" y="974">o</text>
<text x="104" y="974">m</text>
<text x="114" y="974">i</text>
<text x="124" y="974">c</text>
<text x="144" y="974">{</text>
<text x="684" y="974">│</text>
<text x="844" y="974">│</text>
<text x="14" y="994">│</text>
<text x="44" y="994">│</text>
<text x="114" y="994">i</text>
<text x="124" y="994">f</text>
<text x="144" y="994">(</text>
<text x="154" y="994">*</text>
<text x="164" y="994">a</text>
<text x="174" y="994">d</text>
<text x="184" y="994">d</text>
<text x="194" y="994">r</text>
<text x="214" y="994">=</text>
<text x="224" y="994">=</text>
<text x="244" y="994">e</text>
<text x="254" y="994">x</text>
<text x="264" y="994">p</text>
<text x="274" y="994">e</text>
<text x="284" y="994">c</text>
<text x="294" y="994">t</text>
<text x="304" y="994">e</text>
<text x="314" y="994">d</text>
<text x="324" y="994">)</text>
<text x="344" y="994">{</text>
<text x="684" y="994">│</text>
<text x="844" y="994">│</text>
<text x="14" y="1014">│</text>
<text x="44" y="1014">│</text>
<text x="154" y="1014">*</text>
<text x="164" y="1014">a</text>
<text x="174" y="1014">d</text>
<text x="184" y="1014">d</text>
<text x="194" y="1014">r</text>
<text x="214" y="1014">=</text>
<text x="234" y="1014">n</text>
<text x="244" y="1014">e</text>
<text x="254" y="1014">w</text>
<text x="264" y="1014">_</text>
<text x="274" y="1014">v</text>
<text x="284" y="1014">a</text>
<text x="294" y="1014">l</text>
<text x="304" y="1014">u</text>
<text x="314" y="1014">e</text>
<text x="324" y="1014">;</text>
<text x="684" y="1014">│</text>
<text x="844" y="1014">│</text>
<text x="14" y="1034">│</text>
<text x="44" y="1034">│</text>
<text x="154" y="1034">r</text>
<text x="164" y="1034">e</text>
<text x="174" y="1034">t</text>
<text x="184" y="1034">u</text>
<text x="194" y="1034">r</text>
<text x="204" y="1034">n</text>
<text x="224" y="1034">S</text>
<text x="234" y="1034">U</text>
<text x="244" y="1034">C</text>
<text x="254" y="1034">C</text>
<text x="264" y="1034">E</text>
<text x="274" y="1034">S</text>
<text x="284" y="1034">S</text>
<text x="294" y="1034">;</text>
<text x="684" y="1034">│</text>
<text x="844" y="1034">│</text>
<text x="14" y="1054">│</text>
<text x="44" y="1054">│</text>
<text x="114" y="1054">}</text>
<text x="134" y="1054">e</text>
<text x="144" y="1054">l</text>
<text x="154" y="1054">s</text>
<text x="164" y="1054">e</text>
<text x="184" y="1054">{</text>
<text x="684" y="1054">│</text>
<text x="844" y="1054">│</text>
<text x="14" y="1074">│</text>
<text x="44" y="1074">│</text>
<text x="154" y="1074">r</text>
<text x="164" y="1074">e</text>
<text x="174" y="1074">t</text>
<text x="184" y="1074">u</text>
<text x="194" y="1074">r</text>
<text x="204" y="1074">n</text>
<text x="224" y="1074">F</text>
<text x="234" y="1074">A</text>
<text x="244" y="1074">I</text>
<text x="254" y="1074">L</text>
<text x="264" y="1074">;</text>
<text x="334" y="1074">/</text>
<text x="344" y="1074">/</text>
<text x="364" y="1074">呼</text>
<text x="384" y="1074">叫</text>
<text x="404" y="1074">方</text>
<text x="424" y="1074">通</text>
<text x="444" y="1074">常</text>
<text x="464" y="1074">自</text>
<text x="484" y="1074">旋</text>
<text x="504" y="1074">重</text>
<text x="524" y="1074">試</text>
<text x="684" y="1074">│</text>
<text x="844" y="1074">│</text>
<text x="14" y="1094">│</text>
<text x="44" y="1094">│</text>
<text x="114" y="1094">}</text>
<text x="684" y="1094">│</text>
<text x="844" y="1094">│</text>
<text x="14" y="1114">│</text>
<text x="44" y="1114">│</text>
<text x="74" y="1114">}</text>
<text x="684" y="1114">│</text>
<text x="844" y="1114">│</text>
<text x="14" y="1134">│</text>
<text x="44" y="1134">└</text>
<text x="54" y="1134">─</text>
<text x="64" y="1134">─</text>
<text x="74" y="1134">─</text>
<text x="84" y="1134">─</text>
<text x="94" y="1134">─</text>
<text x="104" y="1134">─</text>
<text x="114" y="1134">─</text>
<text x="124" y="1134">─</text>
<text x="134" y="1134">─</text>
<text x="144" y="1134">─</text>
<text x="154" y="1134">─</text>
<text x="164" y="1134">─</text>
<text x="174" y="1134">─</text>
<text x="184" y="1134">─</text>
<text x="194" y="1134">─</text>
<text x="204" y="1134">─</text>
<text x="214" y="1134">─</text>
<text x="224" y="1134">─</text>
<text x="234" y="1134">─</text>
<text x="244" y="1134">─</text>
<text x="254" y="1134">─</text>
<text x="264" y="1134">─</text>
<text x="274" y="1134">─</text>
<text x="284" y="1134">─</text>
<text x="294" y="1134">─</text>
<text x="304" y="1134">─</text>
<text x="314" y="1134">─</text>
<text x="324" y="1134">─</text>
<text x="334" y="1134">─</text>
<text x="344" y="1134">─</text>
<text x="354" y="1134">─</text>
<text x="364" y="1134">─</text>
<text x="374" y="1134">─</text>
<text x="384" y="1134">─</text>
<text x="394" y="1134">─</text>
<text x="404" y="1134">─</text>
<text x="414" y="1134">─</text>
<text x="424" y="1134">─</text>
<text x="434" y="1134">─</text>
<text x="444" y="1134">─</text>
<text x="454" y="1134">─</text>
<text x="464" y="1134">─</text>
<text x="474" y="1134">─</text>
<text x="484" y="1134">─</text>
<text x="494" y="1134">─</text>
<text x="504" y="1134">─</text>
<text x="514" y="1134">─</text>
<text x="524" y="1134">─</text>
<text x="534" y="1134">─</text>
<text x="544" y="1134">─</text>
<text x="554" y="1134">─</text>
<text x="564" y="1134">─</text>
<text x="574" y="1134">─</text>
<text x="584" y="1134">─</text>
<text x="594" y="1134">─</text>
<text x="604" y="1134">─</text>
<text x="614" y="1134">─</text>
<text x="624" y="1134">─</text>
<text x="634" y="1134">─</text>
<text x="644" y="1134">─</text>
<text x="654" y="1134">─</text>
<text x="664" y="1134">─</text>
<text x="674" y="1134">─</text>
<text x="684" y="1134">┘</text>
<text x="844" y="1134">│</text>
<text x="64" y="1154">│</text>
<text x="844" y="1154">│</text>
<text x="14" y="1174">│</text>
<text x="44" y="1174">優</text>
<text x="64" y="1174">點</text>
<text x="84" y="1174">：</text>
<text x="104" y="1174">無</text>
<text x="124" y="1174">鎖</text>
<text x="144" y="1174">、</text>
<text x="164" y="1174">輕</text>
<text x="184" y="1174">量</text>
<text x="204" y="1174">；</text>
<text x="224" y="1174">缺</text>
<text x="244" y="1174">點</text>
<text x="264" y="1174">：</text>
<text x="284" y="1174">A</text>
<text x="294" y="1174">B</text>
<text x="304" y="1174">A</text>
<text x="324" y="1174">問</text>
<text x="344" y="1174">題</text>
<text x="364" y="1174">（</text>
<text x="384" y="1174">需</text>
<text x="404" y="1174">加</text>
<text x="424" y="1174">版</text>
<text x="444" y="1174">本</text>
<text x="464" y="1174">號</text>
<text x="484" y="1174">解</text>
<text x="504" y="1174">決</text>
<text x="524" y="1174">）</text>
<text x="844" y="1174">│</text>
<text x="14" y="1194">└</text>
<text x="24" y="1194">─</text>
<text x="34" y="1194">─</text>
<text x="44" y="1194">─</text>
<text x="54" y="1194">─</text>
<text x="64" y="1194">─</text>
<text x="74" y="1194">─</text>
<text x="84" y="1194">─</text>
<text x="94" y="1194">─</text>
<text x="104" y="1194">─</text>
<text x="114" y="1194">─</text>
<text x="124" y="1194">─</text>
<text x="134" y="1194">─</text>
<text x="144" y="1194">─</text>
<text x="154" y="1194">─</text>
<text x="164" y="1194">─</text>
<text x="174" y="1194">─</text>
<text x="184" y="1194">─</text>
<text x="194" y="1194">─</text>
<text x="204" y="1194">─</text>
<text x="214" y="1194">─</text>
<text x="224" y="1194">─</text>
<text x="234" y="1194">─</text>
<text x="244" y="1194">─</text>
<text x="254" y="1194">─</text>
<text x="264" y="1194">─</text>
<text x="274" y="1194">─</text>
<text x="284" y="1194">─</text>
<text x="294" y="1194">─</text>
<text x="304" y="1194">─</text>
<text x="314" y="1194">─</text>
<text x="324" y="1194">─</text>
<text x="334" y="1194">─</text>
<text x="344" y="1194">─</text>
<text x="354" y="1194">─</text>
<text x="364" y="1194">─</text>
<text x="374" y="1194">─</text>
<text x="384" y="1194">─</text>
<text x="394" y="1194">─</text>
<text x="404" y="1194">─</text>
<text x="414" y="1194">─</text>
<text x="424" y="1194">─</text>
<text x="434" y="1194">─</text>
<text x="444" y="1194">─</text>
<text x="454" y="1194">─</text>
<text x="464" y="1194">─</text>
<text x="474" y="1194">─</text>
<text x="484" y="1194">─</text>
<text x="494" y="1194">─</text>
<text x="504" y="1194">─</text>
<text x="514" y="1194">─</text>
<text x="524" y="1194">─</text>
<text x="534" y="1194">─</text>
<text x="544" y="1194">─</text>
<text x="554" y="1194">─</text>
<text x="564" y="1194">─</text>
<text x="574" y="1194">─</text>
<text x="584" y="1194">─</text>
<text x="594" y="1194">─</text>
<text x="604" y="1194">─</text>
<text x="614" y="1194">─</text>
<text x="624" y="1194">─</text>
<text x="634" y="1194">─</text>
<text x="644" y="1194">─</text>
<text x="654" y="1194">─</text>
<text x="664" y="1194">─</text>
<text x="674" y="1194">─</text>
<text x="684" y="1194">─</text>
<text x="694" y="1194">─</text>
<text x="704" y="1194">─</text>
<text x="714" y="1194">─</text>
<text x="724" y="1194">─</text>
<text x="734" y="1194">─</text>
<text x="744" y="1194">─</text>
<text x="754" y="1194">─</text>
<text x="764" y="1194">─</text>
<text x="774" y="1194">─</text>
<text x="784" y="1194">─</text>
<text x="794" y="1194">─</text>
<text x="804" y="1194">─</text>
<text x="814" y="1194">─</text>
<text x="824" y="1194">─</text>
<text x="834" y="1194">─</text>
<text x="844" y="1194">┘</text>
</g>
</svg>
</div>
<ul>
<li>總線鎖（老方法）</li>
<li>快取鎖（現代常見）</li>
<li>原子指令（如 CAS）</li>
</ul>
<h2 id="53-互斥鎖模型對應-531532"><a class="header" href="#53-互斥鎖模型對應-531532">5.3 互斥鎖模型（對應 5.3.1~5.3.2）</a></h2>
<!-- subsection-diagram -->
<h3 id="本小節示意圖-2"><a class="header" href="#本小節示意圖-2">本小節示意圖</a></h3>
<div class="ascii-svg-wrap">
<svg class="ascii-svg" xmlns="http://www.w3.org/2000/svg" width="798" height="784" viewBox="0 0 798 784" role="img" aria-label="ASCII diagram">
<g fill="currentColor" font-family="Noto Sans Mono CJK TC, Noto Sans Mono CJK SC, Noto Sans Mono CJK JP, Sarasa Mono TC, Cascadia Mono, JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, monospace" font-size="16" text-rendering="geometricPrecision" xml:space="preserve">
<text x="14" y="14">互</text>
<text x="34" y="14">斥</text>
<text x="54" y="14">鎖</text>
<text x="74" y="14">完</text>
<text x="94" y="14">整</text>
<text x="114" y="14">生</text>
<text x="134" y="14">命</text>
<text x="154" y="14">週</text>
<text x="174" y="14">期</text>
<text x="194" y="14">（</text>
<text x="214" y="14">含</text>
<text x="244" y="14">O</text>
<text x="254" y="14">S</text>
<text x="274" y="14">阻</text>
<text x="294" y="14">塞</text>
<text x="314" y="14">/</text>
<text x="324" y="14">喚</text>
<text x="344" y="14">醒</text>
<text x="364" y="14">路</text>
<text x="384" y="14">徑</text>
<text x="404" y="14">）</text>
<text x="424" y="14">：</text>
<text x="34" y="54">T</text>
<text x="44" y="54">h</text>
<text x="54" y="54">r</text>
<text x="64" y="54">e</text>
<text x="74" y="54">a</text>
<text x="84" y="54">d</text>
<text x="104" y="54">1</text>
<text x="124" y="54">時</text>
<text x="144" y="54">間</text>
<text x="164" y="54">軸</text>
<text x="184" y="54">：</text>
<text x="34" y="74">─</text>
<text x="44" y="74">─</text>
<text x="54" y="74">─</text>
<text x="64" y="74">─</text>
<text x="74" y="74">─</text>
<text x="84" y="74">─</text>
<text x="94" y="74">─</text>
<text x="104" y="74">─</text>
<text x="114" y="74">─</text>
<text x="124" y="74">─</text>
<text x="134" y="74">─</text>
<text x="144" y="74">─</text>
<text x="154" y="74">─</text>
<text x="164" y="74">─</text>
<text x="174" y="74">─</text>
<text x="184" y="74">─</text>
<text x="194" y="74">─</text>
<text x="204" y="74">─</text>
<text x="214" y="74">─</text>
<text x="224" y="74">─</text>
<text x="234" y="74">─</text>
<text x="244" y="74">─</text>
<text x="254" y="74">─</text>
<text x="264" y="74">─</text>
<text x="274" y="74">─</text>
<text x="284" y="74">─</text>
<text x="294" y="74">─</text>
<text x="304" y="74">─</text>
<text x="314" y="74">─</text>
<text x="324" y="74">─</text>
<text x="334" y="74">─</text>
<text x="344" y="74">─</text>
<text x="354" y="74">─</text>
<text x="364" y="74">─</text>
<text x="374" y="74">─</text>
<text x="384" y="74">─</text>
<text x="394" y="74">─</text>
<text x="404" y="74">─</text>
<text x="414" y="74">─</text>
<text x="424" y="74">─</text>
<text x="434" y="74">─</text>
<text x="444" y="74">─</text>
<text x="454" y="74">─</text>
<text x="464" y="74">─</text>
<text x="474" y="74">─</text>
<text x="484" y="74">─</text>
<text x="494" y="74">─</text>
<text x="504" y="74">─</text>
<text x="514" y="74">─</text>
<text x="524" y="74">─</text>
<text x="534" y="74">─</text>
<text x="544" y="74">─</text>
<text x="554" y="74">─</text>
<text x="564" y="74">─</text>
<text x="574" y="74">─</text>
<text x="584" y="74">─</text>
<text x="594" y="74">─</text>
<text x="604" y="74">─</text>
<text x="614" y="74">─</text>
<text x="624" y="74">─</text>
<text x="634" y="74">─</text>
<text x="644" y="74">─</text>
<text x="654" y="74">─</text>
<text x="664" y="74">─</text>
<text x="674" y="74">─</text>
<text x="684" y="74">─</text>
<text x="694" y="74">─</text>
<text x="704" y="74">─</text>
<text x="714" y="74">─</text>
<text x="724" y="74">─</text>
<text x="734" y="74">─</text>
<text x="744" y="74">─</text>
<text x="754" y="74">─</text>
<text x="764" y="74">─</text>
<text x="774" y="74">►</text>
<text x="34" y="94">[</text>
<text x="44" y="94">正</text>
<text x="64" y="94">常</text>
<text x="84" y="94">執</text>
<text x="104" y="94">行</text>
<text x="124" y="94">]</text>
<text x="144" y="94">─</text>
<text x="154" y="94">─</text>
<text x="164" y="94">►</text>
<text x="184" y="94">[</text>
<text x="194" y="94">l</text>
<text x="204" y="94">o</text>
<text x="214" y="94">c</text>
<text x="224" y="94">k</text>
<text x="234" y="94">(</text>
<text x="244" y="94">)</text>
<text x="254" y="94">]</text>
<text x="274" y="94">─</text>
<text x="284" y="94">─</text>
<text x="294" y="94">►</text>
<text x="314" y="94">[</text>
<text x="324" y="94">臨</text>
<text x="344" y="94">界</text>
<text x="364" y="94">區</text>
<text x="384" y="94">工</text>
<text x="404" y="94">作</text>
<text x="424" y="94">]</text>
<text x="444" y="94">─</text>
<text x="454" y="94">─</text>
<text x="464" y="94">►</text>
<text x="484" y="94">[</text>
<text x="494" y="94">u</text>
<text x="504" y="94">n</text>
<text x="514" y="94">l</text>
<text x="524" y="94">o</text>
<text x="534" y="94">c</text>
<text x="544" y="94">k</text>
<text x="554" y="94">(</text>
<text x="564" y="94">)</text>
<text x="574" y="94">]</text>
<text x="594" y="94">─</text>
<text x="604" y="94">─</text>
<text x="614" y="94">►</text>
<text x="634" y="94">[</text>
<text x="644" y="94">正</text>
<text x="664" y="94">常</text>
<text x="684" y="94">執</text>
<text x="704" y="94">行</text>
<text x="724" y="94">]</text>
<text x="464" y="114">│</text>
<text x="774" y="114">│</text>
<text x="194" y="134">│</text>
<text x="214" y="134">成</text>
<text x="234" y="134">功</text>
<text x="254" y="134">獲</text>
<text x="274" y="134">取</text>
<text x="294" y="134">鎖</text>
<text x="314" y="134">（</text>
<text x="334" y="134">快</text>
<text x="354" y="134">路</text>
<text x="374" y="134">徑</text>
<text x="394" y="134">，</text>
<text x="544" y="134">│</text>
<text x="564" y="134">釋</text>
<text x="584" y="134">放</text>
<text x="604" y="134">鎖</text>
<text x="194" y="154">│</text>
<text x="214" y="154">f</text>
<text x="224" y="154">u</text>
<text x="234" y="154">t</text>
<text x="244" y="154">e</text>
<text x="254" y="154">x</text>
<text x="274" y="154">不</text>
<text x="294" y="154">陷</text>
<text x="314" y="154">入</text>
<text x="334" y="154">核</text>
<text x="354" y="154">心</text>
<text x="374" y="154">）</text>
<text x="774" y="154">│</text>
<text x="194" y="174">▼</text>
<text x="504" y="174">▼</text>
<text x="134" y="194">進</text>
<text x="154" y="194">入</text>
<text x="174" y="194">臨</text>
<text x="194" y="194">界</text>
<text x="214" y="194">區</text>
<text x="454" y="194">喚</text>
<text x="474" y="194">醒</text>
<text x="494" y="194">等</text>
<text x="514" y="194">待</text>
<text x="534" y="194">佇</text>
<text x="554" y="194">列</text>
<text x="574" y="194">中</text>
<text x="594" y="194">的</text>
<text x="624" y="194">T</text>
<text x="634" y="194">h</text>
<text x="644" y="194">r</text>
<text x="654" y="194">e</text>
<text x="664" y="194">a</text>
<text x="674" y="194">d</text>
<text x="694" y="194">2</text>
<text x="34" y="234">T</text>
<text x="44" y="234">h</text>
<text x="54" y="234">r</text>
<text x="64" y="234">e</text>
<text x="74" y="234">a</text>
<text x="84" y="234">d</text>
<text x="104" y="234">2</text>
<text x="124" y="234">時</text>
<text x="144" y="234">間</text>
<text x="164" y="234">軸</text>
<text x="184" y="234">（</text>
<text x="204" y="234">競</text>
<text x="224" y="234">爭</text>
<text x="244" y="234">失</text>
<text x="264" y="234">敗</text>
<text x="284" y="234">的</text>
<text x="304" y="234">情</text>
<text x="324" y="234">況</text>
<text x="344" y="234">）</text>
<text x="364" y="234">：</text>
<text x="34" y="254">─</text>
<text x="44" y="254">─</text>
<text x="54" y="254">─</text>
<text x="64" y="254">─</text>
<text x="74" y="254">─</text>
<text x="84" y="254">─</text>
<text x="94" y="254">─</text>
<text x="104" y="254">─</text>
<text x="114" y="254">─</text>
<text x="124" y="254">─</text>
<text x="134" y="254">─</text>
<text x="144" y="254">─</text>
<text x="154" y="254">─</text>
<text x="164" y="254">─</text>
<text x="174" y="254">─</text>
<text x="184" y="254">─</text>
<text x="194" y="254">─</text>
<text x="204" y="254">─</text>
<text x="214" y="254">─</text>
<text x="224" y="254">─</text>
<text x="234" y="254">─</text>
<text x="244" y="254">─</text>
<text x="254" y="254">─</text>
<text x="264" y="254">─</text>
<text x="274" y="254">─</text>
<text x="284" y="254">─</text>
<text x="294" y="254">─</text>
<text x="304" y="254">─</text>
<text x="314" y="254">─</text>
<text x="324" y="254">─</text>
<text x="334" y="254">─</text>
<text x="344" y="254">─</text>
<text x="354" y="254">─</text>
<text x="364" y="254">─</text>
<text x="374" y="254">─</text>
<text x="384" y="254">─</text>
<text x="394" y="254">─</text>
<text x="404" y="254">─</text>
<text x="414" y="254">─</text>
<text x="424" y="254">─</text>
<text x="434" y="254">─</text>
<text x="444" y="254">─</text>
<text x="454" y="254">─</text>
<text x="464" y="254">─</text>
<text x="474" y="254">─</text>
<text x="484" y="254">─</text>
<text x="494" y="254">─</text>
<text x="504" y="254">─</text>
<text x="514" y="254">─</text>
<text x="524" y="254">─</text>
<text x="534" y="254">─</text>
<text x="544" y="254">─</text>
<text x="554" y="254">─</text>
<text x="564" y="254">─</text>
<text x="574" y="254">─</text>
<text x="584" y="254">─</text>
<text x="594" y="254">─</text>
<text x="604" y="254">─</text>
<text x="614" y="254">─</text>
<text x="624" y="254">─</text>
<text x="634" y="254">─</text>
<text x="644" y="254">─</text>
<text x="654" y="254">─</text>
<text x="664" y="254">─</text>
<text x="674" y="254">─</text>
<text x="684" y="254">─</text>
<text x="694" y="254">─</text>
<text x="704" y="254">─</text>
<text x="714" y="254">─</text>
<text x="724" y="254">─</text>
<text x="734" y="254">─</text>
<text x="744" y="254">─</text>
<text x="754" y="254">─</text>
<text x="764" y="254">─</text>
<text x="774" y="254">►</text>
<text x="34" y="274">[</text>
<text x="44" y="274">正</text>
<text x="64" y="274">常</text>
<text x="84" y="274">執</text>
<text x="104" y="274">行</text>
<text x="124" y="274">]</text>
<text x="144" y="274">─</text>
<text x="154" y="274">─</text>
<text x="164" y="274">►</text>
<text x="184" y="274">[</text>
<text x="194" y="274">l</text>
<text x="204" y="274">o</text>
<text x="214" y="274">c</text>
<text x="224" y="274">k</text>
<text x="234" y="274">(</text>
<text x="244" y="274">)</text>
<text x="254" y="274">]</text>
<text x="274" y="274">─</text>
<text x="284" y="274">─</text>
<text x="294" y="274">►</text>
<text x="314" y="274">░</text>
<text x="324" y="274">░</text>
<text x="334" y="274">░</text>
<text x="344" y="274">░</text>
<text x="354" y="274">░</text>
<text x="364" y="274">░</text>
<text x="374" y="274">░</text>
<text x="384" y="274">░</text>
<text x="394" y="274">░</text>
<text x="404" y="274">░</text>
<text x="414" y="274">░</text>
<text x="424" y="274">░</text>
<text x="434" y="274">░</text>
<text x="444" y="274">░</text>
<text x="454" y="274">░</text>
<text x="464" y="274">░</text>
<text x="474" y="274">░</text>
<text x="484" y="274">░</text>
<text x="494" y="274">░</text>
<text x="504" y="274">░</text>
<text x="514" y="274">░</text>
<text x="524" y="274">░</text>
<text x="544" y="274">─</text>
<text x="554" y="274">─</text>
<text x="564" y="274">►</text>
<text x="584" y="274">[</text>
<text x="594" y="274">臨</text>
<text x="614" y="274">界</text>
<text x="634" y="274">區</text>
<text x="654" y="274">工</text>
<text x="674" y="274">作</text>
<text x="694" y="274">]</text>
<text x="714" y="274">─</text>
<text x="724" y="274">─</text>
<text x="734" y="274">►</text>
<text x="194" y="294">│</text>
<text x="314" y="294">▲</text>
<text x="504" y="294">▲</text>
<text x="194" y="314">│</text>
<text x="244" y="314">阻</text>
<text x="264" y="314">塞</text>
<text x="284" y="314">等</text>
<text x="304" y="314">待</text>
<text x="324" y="314">（</text>
<text x="344" y="314">O</text>
<text x="354" y="314">S</text>
<text x="374" y="314">掛</text>
<text x="394" y="314">起</text>
<text x="424" y="314">T</text>
<text x="434" y="314">h</text>
<text x="444" y="314">r</text>
<text x="454" y="314">e</text>
<text x="464" y="314">a</text>
<text x="474" y="314">d</text>
<text x="494" y="314">2</text>
<text x="504" y="314">）</text>
<text x="524" y="314">│</text>
<text x="544" y="314">被</text>
<text x="564" y="314">喚</text>
<text x="584" y="314">醒</text>
<text x="604" y="314">，</text>
<text x="624" y="314">重</text>
<text x="644" y="314">新</text>
<text x="664" y="314">競</text>
<text x="684" y="314">爭</text>
<text x="194" y="334">▼</text>
<text x="774" y="334">│</text>
<text x="114" y="354">┌</text>
<text x="124" y="354">─</text>
<text x="134" y="354">─</text>
<text x="144" y="354">─</text>
<text x="154" y="354">─</text>
<text x="164" y="354">─</text>
<text x="174" y="354">─</text>
<text x="184" y="354">─</text>
<text x="194" y="354">─</text>
<text x="204" y="354">─</text>
<text x="214" y="354">─</text>
<text x="224" y="354">─</text>
<text x="234" y="354">─</text>
<text x="244" y="354">─</text>
<text x="254" y="354">─</text>
<text x="264" y="354">─</text>
<text x="274" y="354">─</text>
<text x="284" y="354">─</text>
<text x="294" y="354">─</text>
<text x="304" y="354">─</text>
<text x="314" y="354">─</text>
<text x="324" y="354">─</text>
<text x="334" y="354">─</text>
<text x="344" y="354">─</text>
<text x="354" y="354">─</text>
<text x="364" y="354">─</text>
<text x="374" y="354">─</text>
<text x="384" y="354">─</text>
<text x="394" y="354">─</text>
<text x="404" y="354">─</text>
<text x="414" y="354">─</text>
<text x="424" y="354">─</text>
<text x="434" y="354">─</text>
<text x="444" y="354">─</text>
<text x="454" y="354">─</text>
<text x="464" y="354">─</text>
<text x="474" y="354">─</text>
<text x="484" y="354">─</text>
<text x="494" y="354">─</text>
<text x="504" y="354">─</text>
<text x="514" y="354">─</text>
<text x="524" y="354">─</text>
<text x="534" y="354">─</text>
<text x="544" y="354">─</text>
<text x="554" y="354">─</text>
<text x="564" y="354">─</text>
<text x="574" y="354">─</text>
<text x="584" y="354">┐</text>
<text x="774" y="354">│</text>
<text x="114" y="374">│</text>
<text x="144" y="374">O</text>
<text x="154" y="374">S</text>
<text x="174" y="374">核</text>
<text x="194" y="374">心</text>
<text x="214" y="374">層</text>
<text x="584" y="374">│</text>
<text x="774" y="374">│</text>
<text x="394" y="394">│</text>
<text x="584" y="394">│</text>
<text x="774" y="394">│</text>
<text x="114" y="414">│</text>
<text x="144" y="414">f</text>
<text x="154" y="414">u</text>
<text x="164" y="414">t</text>
<text x="174" y="414">e</text>
<text x="184" y="414">x</text>
<text x="204" y="414">系</text>
<text x="224" y="414">統</text>
<text x="244" y="414">呼</text>
<text x="264" y="414">叫</text>
<text x="584" y="414">│</text>
<text x="774" y="414">│</text>
<text x="114" y="434">│</text>
<text x="144" y="434">T</text>
<text x="154" y="434">h</text>
<text x="164" y="434">r</text>
<text x="174" y="434">e</text>
<text x="184" y="434">a</text>
<text x="194" y="434">d</text>
<text x="204" y="434">2</text>
<text x="224" y="434">進</text>
<text x="244" y="434">入</text>
<text x="584" y="434">│</text>
<text x="774" y="434">│</text>
<text x="114" y="454">│</text>
<text x="144" y="454">等</text>
<text x="164" y="454">待</text>
<text x="184" y="454">佇</text>
<text x="204" y="454">列</text>
<text x="224" y="454">（</text>
<text x="244" y="454">睡</text>
<text x="264" y="454">眠</text>
<text x="284" y="454">）</text>
<text x="324" y="454">│</text>
<text x="334" y="454">─</text>
<text x="344" y="454">─</text>
<text x="354" y="454">─</text>
<text x="364" y="454">─</text>
<text x="374" y="454">─</text>
<text x="384" y="454">─</text>
<text x="394" y="454">─</text>
<text x="404" y="454">─</text>
<text x="414" y="454">─</text>
<text x="424" y="454">─</text>
<text x="434" y="454">─</text>
<text x="444" y="454">─</text>
<text x="454" y="454">─</text>
<text x="464" y="454">─</text>
<text x="474" y="454">─</text>
<text x="484" y="454">─</text>
<text x="494" y="454">─</text>
<text x="504" y="454">─</text>
<text x="514" y="454">─</text>
<text x="524" y="454">─</text>
<text x="534" y="454">─</text>
<text x="544" y="454">─</text>
<text x="554" y="454">─</text>
<text x="564" y="454">─</text>
<text x="574" y="454">─</text>
<text x="584" y="454">─</text>
<text x="594" y="454">─</text>
<text x="604" y="454">─</text>
<text x="614" y="454">─</text>
<text x="624" y="454">─</text>
<text x="634" y="454">─</text>
<text x="644" y="454">─</text>
<text x="654" y="454">─</text>
<text x="664" y="454">─</text>
<text x="674" y="454">─</text>
<text x="684" y="454">─</text>
<text x="694" y="454">─</text>
<text x="704" y="454">─</text>
<text x="714" y="454">─</text>
<text x="724" y="454">─</text>
<text x="734" y="454">─</text>
<text x="744" y="454">─</text>
<text x="754" y="454">─</text>
<text x="764" y="454">─</text>
<text x="774" y="454">┘</text>
<text x="114" y="474">│</text>
<text x="304" y="474">│</text>
<text x="354" y="474">T</text>
<text x="364" y="474">h</text>
<text x="374" y="474">r</text>
<text x="384" y="474">e</text>
<text x="394" y="474">a</text>
<text x="404" y="474">d</text>
<text x="414" y="474">1</text>
<text x="434" y="474">u</text>
<text x="444" y="474">n</text>
<text x="454" y="474">l</text>
<text x="464" y="474">o</text>
<text x="474" y="474">c</text>
<text x="484" y="474">k</text>
<text x="494" y="474">(</text>
<text x="504" y="474">)</text>
<text x="524" y="474">後</text>
<text x="114" y="494">└</text>
<text x="124" y="494">─</text>
<text x="134" y="494">─</text>
<text x="144" y="494">─</text>
<text x="154" y="494">─</text>
<text x="164" y="494">─</text>
<text x="174" y="494">─</text>
<text x="184" y="494">─</text>
<text x="194" y="494">─</text>
<text x="204" y="494">─</text>
<text x="214" y="494">─</text>
<text x="224" y="494">─</text>
<text x="234" y="494">─</text>
<text x="244" y="494">─</text>
<text x="254" y="494">─</text>
<text x="264" y="494">─</text>
<text x="274" y="494">─</text>
<text x="284" y="494">─</text>
<text x="294" y="494">─</text>
<text x="304" y="494">┘</text>
<text x="354" y="494">O</text>
<text x="364" y="494">S</text>
<text x="384" y="494">喚</text>
<text x="404" y="494">醒</text>
<text x="434" y="494">T</text>
<text x="444" y="494">h</text>
<text x="454" y="494">r</text>
<text x="464" y="494">e</text>
<text x="474" y="494">a</text>
<text x="484" y="494">d</text>
<text x="494" y="494">2</text>
<text x="34" y="534">鎖</text>
<text x="54" y="534">的</text>
<text x="74" y="534">兩</text>
<text x="94" y="534">個</text>
<text x="114" y="534">路</text>
<text x="134" y="534">徑</text>
<text x="154" y="534">：</text>
<text x="34" y="574">快</text>
<text x="54" y="574">路</text>
<text x="74" y="574">徑</text>
<text x="94" y="574">（</text>
<text x="114" y="574">F</text>
<text x="124" y="574">a</text>
<text x="134" y="574">s</text>
<text x="144" y="574">t</text>
<text x="164" y="574">P</text>
<text x="174" y="574">a</text>
<text x="184" y="574">t</text>
<text x="194" y="574">h</text>
<text x="204" y="574">）</text>
<text x="224" y="574">—</text>
<text x="234" y="574">—</text>
<text x="254" y="574">無</text>
<text x="274" y="574">競</text>
<text x="294" y="574">爭</text>
<text x="314" y="574">：</text>
<text x="34" y="594">l</text>
<text x="44" y="594">o</text>
<text x="54" y="594">c</text>
<text x="64" y="594">k</text>
<text x="74" y="594">(</text>
<text x="84" y="594">)</text>
<text x="104" y="594">─</text>
<text x="114" y="594">─</text>
<text x="124" y="594">►</text>
<text x="144" y="594">C</text>
<text x="154" y="594">A</text>
<text x="164" y="594">S</text>
<text x="184" y="594">操</text>
<text x="204" y="594">作</text>
<text x="224" y="594">成</text>
<text x="244" y="594">功</text>
<text x="274" y="594">─</text>
<text x="284" y="594">─</text>
<text x="294" y="594">►</text>
<text x="314" y="594">進</text>
<text x="334" y="594">入</text>
<text x="354" y="594">臨</text>
<text x="374" y="594">界</text>
<text x="394" y="594">區</text>
<text x="504" y="594">（</text>
<text x="524" y="594">不</text>
<text x="544" y="594">需</text>
<text x="564" y="594">要</text>
<text x="594" y="594">s</text>
<text x="604" y="594">y</text>
<text x="614" y="594">s</text>
<text x="624" y="594">c</text>
<text x="634" y="594">a</text>
<text x="644" y="594">l</text>
<text x="654" y="594">l</text>
<text x="664" y="594">，</text>
<text x="684" y="594">最</text>
<text x="704" y="594">快</text>
<text x="724" y="594">）</text>
<text x="34" y="634">慢</text>
<text x="54" y="634">路</text>
<text x="74" y="634">徑</text>
<text x="94" y="634">（</text>
<text x="114" y="634">S</text>
<text x="124" y="634">l</text>
<text x="134" y="634">o</text>
<text x="144" y="634">w</text>
<text x="164" y="634">P</text>
<text x="174" y="634">a</text>
<text x="184" y="634">t</text>
<text x="194" y="634">h</text>
<text x="204" y="634">）</text>
<text x="224" y="634">—</text>
<text x="234" y="634">—</text>
<text x="254" y="634">有</text>
<text x="274" y="634">競</text>
<text x="294" y="634">爭</text>
<text x="314" y="634">：</text>
<text x="34" y="654">l</text>
<text x="44" y="654">o</text>
<text x="54" y="654">c</text>
<text x="64" y="654">k</text>
<text x="74" y="654">(</text>
<text x="84" y="654">)</text>
<text x="104" y="654">─</text>
<text x="114" y="654">─</text>
<text x="124" y="654">►</text>
<text x="144" y="654">C</text>
<text x="154" y="654">A</text>
<text x="164" y="654">S</text>
<text x="184" y="654">失</text>
<text x="204" y="654">敗</text>
<text x="234" y="654">─</text>
<text x="244" y="654">─</text>
<text x="254" y="654">►</text>
<text x="274" y="654">f</text>
<text x="284" y="654">u</text>
<text x="294" y="654">t</text>
<text x="304" y="654">e</text>
<text x="314" y="654">x</text>
<text x="324" y="654">_</text>
<text x="334" y="654">w</text>
<text x="344" y="654">a</text>
<text x="354" y="654">i</text>
<text x="364" y="654">t</text>
<text x="374" y="654">（</text>
<text x="394" y="654">陷</text>
<text x="414" y="654">入</text>
<text x="434" y="654">核</text>
<text x="454" y="654">心</text>
<text x="474" y="654">）</text>
<text x="124" y="674">─</text>
<text x="134" y="674">─</text>
<text x="144" y="674">►</text>
<text x="164" y="674">睡</text>
<text x="184" y="674">眠</text>
<text x="204" y="674">等</text>
<text x="224" y="674">待</text>
<text x="254" y="674">─</text>
<text x="264" y="674">─</text>
<text x="274" y="674">►</text>
<text x="294" y="674">被</text>
<text x="324" y="674">u</text>
<text x="334" y="674">n</text>
<text x="344" y="674">l</text>
<text x="354" y="674">o</text>
<text x="364" y="674">c</text>
<text x="374" y="674">k</text>
<text x="394" y="674">方</text>
<text x="414" y="674">的</text>
<text x="444" y="674">f</text>
<text x="454" y="674">u</text>
<text x="464" y="674">t</text>
<text x="474" y="674">e</text>
<text x="484" y="674">x</text>
<text x="494" y="674">_</text>
<text x="504" y="674">w</text>
<text x="514" y="674">a</text>
<text x="524" y="674">k</text>
<text x="534" y="674">e</text>
<text x="554" y="674">喚</text>
<text x="574" y="674">醒</text>
<text x="124" y="694">─</text>
<text x="134" y="694">─</text>
<text x="144" y="694">►</text>
<text x="164" y="694">重</text>
<text x="184" y="694">新</text>
<text x="204" y="694">嘗</text>
<text x="224" y="694">試</text>
<text x="254" y="694">C</text>
<text x="264" y="694">A</text>
<text x="274" y="694">S</text>
<text x="294" y="694">─</text>
<text x="304" y="694">─</text>
<text x="314" y="694">►</text>
<text x="334" y="694">進</text>
<text x="354" y="694">入</text>
<text x="374" y="694">臨</text>
<text x="394" y="694">界</text>
<text x="414" y="694">區</text>
<text x="34" y="734">⚠</text>
<text x="54" y="734">每</text>
<text x="74" y="734">次</text>
<text x="104" y="734">s</text>
<text x="114" y="734">y</text>
<text x="124" y="734">s</text>
<text x="134" y="734">c</text>
<text x="144" y="734">a</text>
<text x="154" y="734">l</text>
<text x="164" y="734">l</text>
<text x="174" y="734">（</text>
<text x="194" y="734">陷</text>
<text x="214" y="734">入</text>
<text x="234" y="734">核</text>
<text x="254" y="734">心</text>
<text x="274" y="734">）</text>
<text x="294" y="734">大</text>
<text x="314" y="734">約</text>
<text x="334" y="734">耗</text>
<text x="354" y="734">時</text>
<text x="384" y="734">1</text>
<text x="394" y="734">0</text>
<text x="404" y="734">0</text>
<text x="414" y="734">0</text>
<text x="424" y="734">~</text>
<text x="434" y="734">5</text>
<text x="444" y="734">0</text>
<text x="454" y="734">0</text>
<text x="464" y="734">0</text>
<text x="484" y="734">n</text>
<text x="494" y="734">s</text>
<text x="34" y="754">⚠</text>
<text x="54" y="754">高</text>
<text x="74" y="754">競</text>
<text x="94" y="754">爭</text>
<text x="114" y="754">下</text>
<text x="134" y="754">鎖</text>
<text x="154" y="754">的</text>
<text x="174" y="754">開</text>
<text x="194" y="754">銷</text>
<text x="214" y="754">可</text>
<text x="234" y="754">能</text>
<text x="254" y="754">超</text>
<text x="274" y="754">過</text>
<text x="294" y="754">臨</text>
<text x="314" y="754">界</text>
<text x="334" y="754">區</text>
<text x="354" y="754">本</text>
<text x="374" y="754">身</text>
<text x="394" y="754">的</text>
<text x="414" y="754">工</text>
<text x="434" y="754">作</text>
<text x="454" y="754">量</text>
</g>
</svg>
</div>
<p>鎖把臨界區包起來，保證同時只有一個執行緒改共享資料。</p>
<h2 id="54-cas"><a class="header" href="#54-cas">5.4 CAS</a></h2>
<!-- subsection-diagram -->
<h3 id="本小節示意圖-3"><a class="header" href="#本小節示意圖-3">本小節示意圖</a></h3>
<div class="ascii-svg-wrap">
<svg class="ascii-svg" xmlns="http://www.w3.org/2000/svg" width="798" height="1044" viewBox="0 0 798 1044" role="img" aria-label="ASCII diagram">
<g fill="currentColor" font-family="Noto Sans Mono CJK TC, Noto Sans Mono CJK SC, Noto Sans Mono CJK JP, Sarasa Mono TC, Cascadia Mono, JetBrains Mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, monospace" font-size="16" text-rendering="geometricPrecision" xml:space="preserve">
<text x="14" y="14">C</text>
<text x="24" y="14">A</text>
<text x="34" y="14">S</text>
<text x="44" y="14">（</text>
<text x="64" y="14">C</text>
<text x="74" y="14">o</text>
<text x="84" y="14">m</text>
<text x="94" y="14">p</text>
<text x="104" y="14">a</text>
<text x="114" y="14">r</text>
<text x="124" y="14">e</text>
<text x="134" y="14">-</text>
<text x="144" y="14">A</text>
<text x="154" y="14">n</text>
<text x="164" y="14">d</text>
<text x="174" y="14">-</text>
<text x="184" y="14">S</text>
<text x="194" y="14">w</text>
<text x="204" y="14">a</text>
<text x="214" y="14">p</text>
<text x="224" y="14">）</text>
<text x="244" y="14">完</text>
<text x="264" y="14">整</text>
<text x="284" y="14">流</text>
<text x="304" y="14">程</text>
<text x="324" y="14">：</text>
<text x="34" y="54">呼</text>
<text x="54" y="54">叫</text>
<text x="74" y="54">：</text>
<text x="94" y="54">C</text>
<text x="104" y="54">A</text>
<text x="114" y="54">S</text>
<text x="124" y="54">(</text>
<text x="134" y="54">a</text>
<text x="144" y="54">d</text>
<text x="154" y="54">d</text>
<text x="164" y="54">r</text>
<text x="174" y="54">,</text>
<text x="194" y="54">e</text>
<text x="204" y="54">x</text>
<text x="214" y="54">p</text>
<text x="224" y="54">e</text>
<text x="234" y="54">c</text>
<text x="244" y="54">t</text>
<text x="254" y="54">e</text>
<text x="264" y="54">d</text>
<text x="274" y="54">=</text>
<text x="284" y="54">1</text>
<text x="294" y="54">0</text>
<text x="304" y="54">,</text>
<text x="324" y="54">n</text>
<text x="334" y="54">e</text>
<text x="344" y="54">w</text>
<text x="354" y="54">=</text>
<text x="364" y="54">1</text>
<text x="374" y="54">1</text>
<text x="384" y="54">)</text>
<text x="34" y="94">┌</text>
<text x="44" y="94">─</text>
<text x="54" y="94">─</text>
<text x="64" y="94">─</text>
<text x="74" y="94">─</text>
<text x="84" y="94">─</text>
<text x="94" y="94">─</text>
<text x="104" y="94">─</text>
<text x="114" y="94">─</text>
<text x="124" y="94">─</text>
<text x="134" y="94">─</text>
<text x="144" y="94">─</text>
<text x="154" y="94">─</text>
<text x="164" y="94">─</text>
<text x="174" y="94">─</text>
<text x="184" y="94">─</text>
<text x="194" y="94">─</text>
<text x="204" y="94">─</text>
<text x="214" y="94">─</text>
<text x="224" y="94">─</text>
<text x="234" y="94">─</text>
<text x="244" y="94">─</text>
<text x="254" y="94">─</text>
<text x="264" y="94">─</text>
<text x="274" y="94">─</text>
<text x="284" y="94">─</text>
<text x="294" y="94">─</text>
<text x="304" y="94">─</text>
<text x="314" y="94">─</text>
<text x="324" y="94">─</text>
<text x="334" y="94">─</text>
<text x="344" y="94">─</text>
<text x="354" y="94">─</text>
<text x="364" y="94">─</text>
<text x="374" y="94">─</text>
<text x="384" y="94">─</text>
<text x="394" y="94">─</text>
<text x="404" y="94">─</text>
<text x="414" y="94">─</text>
<text x="424" y="94">─</text>
<text x="434" y="94">─</text>
<text x="444" y="94">─</text>
<text x="454" y="94">─</text>
<text x="464" y="94">─</text>
<text x="474" y="94">─</text>
<text x="484" y="94">─</text>
<text x="494" y="94">─</text>
<text x="504" y="94">─</text>
<text x="514" y="94">─</text>
<text x="524" y="94">─</text>
<text x="534" y="94">─</text>
<text x="544" y="94">─</text>
<text x="554" y="94">─</text>
<text x="564" y="94">─</text>
<text x="574" y="94">─</text>
<text x="584" y="94">─</text>
<text x="594" y="94">─</text>
<text x="604" y="94">─</text>
<text x="614" y="94">─</text>
<text x="624" y="94">─</text>
<text x="634" y="94">─</text>
<text x="644" y="94">─</text>
<text x="654" y="94">─</text>
<text x="664" y="94">─</text>
<text x="674" y="94">─</text>
<text x="684" y="94">─</text>
<text x="694" y="94">─</text>
<text x="704" y="94">─</text>
<text x="714" y="94">─</text>
<text x="724" y="94">─</text>
<text x="734" y="94">─</text>
<text x="744" y="94">─</text>
<text x="754" y="94">─</text>
<text x="764" y="94">─</text>
<text x="774" y="94">┐</text>
<text x="74" y="114">│</text>
<text x="774" y="114">│</text>
<text x="34" y="134">│</text>
<text x="64" y="134">①</text>
<text x="84" y="134">L</text>
<text x="94" y="134">o</text>
<text x="104" y="134">a</text>
<text x="114" y="134">d</text>
<text x="134" y="134">o</text>
<text x="144" y="134">l</text>
<text x="154" y="134">d</text>
<text x="174" y="134">v</text>
<text x="184" y="134">a</text>
<text x="194" y="134">l</text>
<text x="204" y="134">u</text>
<text x="214" y="134">e</text>
<text x="774" y="134">│</text>
<text x="34" y="154">│</text>
<text x="94" y="154">o</text>
<text x="104" y="154">l</text>
<text x="114" y="154">d</text>
<text x="134" y="154">=</text>
<text x="154" y="154">*</text>
<text x="164" y="154">a</text>
<text x="174" y="154">d</text>
<text x="184" y="154">d</text>
<text x="194" y="154">r</text>
<text x="234" y="154">→</text>
<text x="254" y="154">o</text>
<text x="264" y="154">l</text>
<text x="274" y="154">d</text>
<text x="294" y="154">=</text>
<text x="314" y="154">1</text>
<text x="324" y="154">0</text>
<text x="774" y="154">│</text>
<text x="74" y="174">│</text>
<text x="344" y="174">│</text>
<text x="774" y="174">│</text>
<text x="34" y="194">│</text>
<text x="64" y="194">②</text>
<text x="84" y="194">C</text>
<text x="94" y="194">o</text>
<text x="104" y="194">m</text>
<text x="114" y="194">p</text>
<text x="124" y="194">a</text>
<text x="134" y="194">r</text>
<text x="144" y="194">e</text>
<text x="774" y="194">│</text>
<text x="34" y="214">│</text>
<text x="94" y="214">o</text>
<text x="104" y="214">l</text>
<text x="114" y="214">d</text>
<text x="134" y="214">=</text>
<text x="144" y="214">=</text>
<text x="164" y="214">e</text>
<text x="174" y="214">x</text>
<text x="184" y="214">p</text>
<text x="194" y="214">e</text>
<text x="204" y="214">c</text>
<text x="214" y="214">t</text>
<text x="224" y="214">e</text>
<text x="234" y="214">d</text>
<text x="244" y="214">?</text>
<text x="274" y="214">1</text>
<text x="284" y="214">0</text>
<text x="304" y="214">=</text>
<text x="314" y="214">=</text>
<text x="334" y="214">1</text>
<text x="344" y="214">0</text>
<text x="364" y="214">?</text>
<text x="774" y="214">│</text>
<text x="74" y="234">│</text>
<text x="344" y="234">│</text>
<text x="774" y="234">│</text>
<text x="34" y="254">│</text>
<text x="184" y="254">┌</text>
<text x="194" y="254">─</text>
<text x="204" y="254">─</text>
<text x="214" y="254">─</text>
<text x="224" y="254">─</text>
<text x="234" y="254">─</text>
<text x="244" y="254">─</text>
<text x="254" y="254">─</text>
<text x="264" y="254">─</text>
<text x="274" y="254">─</text>
<text x="284" y="254">─</text>
<text x="294" y="254">─</text>
<text x="304" y="254">┴</text>
<text x="314" y="254">─</text>
<text x="324" y="254">─</text>
<text x="334" y="254">─</text>
<text x="344" y="254">─</text>
<text x="354" y="254">─</text>
<text x="364" y="254">─</text>
<text x="374" y="254">─</text>
<text x="384" y="254">─</text>
<text x="394" y="254">─</text>
<text x="404" y="254">─</text>
<text x="414" y="254">─</text>
<text x="424" y="254">─</text>
<text x="434" y="254">─</text>
<text x="444" y="254">─</text>
<text x="454" y="254">─</text>
<text x="464" y="254">┐</text>
<text x="774" y="254">│</text>
<text x="34" y="274">│</text>
<text x="184" y="274">│</text>
<text x="204" y="274">Y</text>
<text x="214" y="274">E</text>
<text x="224" y="274">S</text>
<text x="234" y="274">（</text>
<text x="254" y="274">匹</text>
<text x="274" y="274">配</text>
<text x="294" y="274">）</text>
<text x="434" y="274">│</text>
<text x="454" y="274">N</text>
<text x="464" y="274">O</text>
<text x="474" y="274">（</text>
<text x="494" y="274">不</text>
<text x="514" y="274">匹</text>
<text x="534" y="274">配</text>
<text x="554" y="274">）</text>
<text x="774" y="274">│</text>
<text x="34" y="294">│</text>
<text x="184" y="294">▼</text>
<text x="424" y="294">▼</text>
<text x="774" y="294">│</text>
<text x="34" y="314">│</text>
<text x="64" y="314">③</text>
<text x="74" y="314">a</text>
<text x="94" y="314">S</text>
<text x="104" y="314">w</text>
<text x="114" y="314">a</text>
<text x="124" y="314">p</text>
<text x="144" y="314">n</text>
<text x="154" y="314">e</text>
<text x="164" y="314">w</text>
<text x="184" y="314">v</text>
<text x="194" y="314">a</text>
<text x="204" y="314">l</text>
<text x="214" y="314">u</text>
<text x="224" y="314">e</text>
<text x="294" y="314">③</text>
<text x="304" y="314">b</text>
<text x="324" y="314">返</text>
<text x="344" y="314">回</text>
<text x="374" y="314">F</text>
<text x="384" y="314">A</text>
<text x="394" y="314">I</text>
<text x="404" y="314">L</text>
<text x="774" y="314">│</text>
<text x="34" y="334">│</text>
<text x="94" y="334">*</text>
<text x="104" y="334">a</text>
<text x="114" y="334">d</text>
<text x="124" y="334">d</text>
<text x="134" y="334">r</text>
<text x="154" y="334">=</text>
<text x="174" y="334">n</text>
<text x="184" y="334">e</text>
<text x="194" y="334">w</text>
<text x="214" y="334">=</text>
<text x="234" y="334">1</text>
<text x="244" y="334">1</text>
<text x="334" y="334">呼</text>
<text x="354" y="334">叫</text>
<text x="374" y="334">方</text>
<text x="394" y="334">重</text>
<text x="414" y="334">試</text>
<text x="774" y="334">│</text>
<text x="34" y="354">│</text>
<text x="94" y="354">返</text>
<text x="114" y="354">回</text>
<text x="144" y="354">S</text>
<text x="154" y="354">U</text>
<text x="164" y="354">C</text>
<text x="174" y="354">C</text>
<text x="184" y="354">E</text>
<text x="194" y="354">S</text>
<text x="204" y="354">S</text>
<text x="394" y="354">│</text>
<text x="774" y="354">│</text>
<text x="74" y="374">│</text>
<text x="224" y="374">│</text>
<text x="394" y="374">│</text>
<text x="774" y="374">│</text>
<text x="34" y="394">│</text>
<text x="184" y="394">└</text>
<text x="194" y="394">─</text>
<text x="204" y="394">─</text>
<text x="214" y="394">─</text>
<text x="224" y="394">─</text>
<text x="234" y="394">─</text>
<text x="244" y="394">─</text>
<text x="254" y="394">─</text>
<text x="264" y="394">─</text>
<text x="274" y="394">─</text>
<text x="284" y="394">─</text>
<text x="294" y="394">─</text>
<text x="304" y="394">┬</text>
<text x="314" y="394">─</text>
<text x="324" y="394">─</text>
<text x="334" y="394">─</text>
<text x="344" y="394">─</text>
<text x="354" y="394">─</text>
<text x="364" y="394">─</text>
<text x="374" y="394">─</text>
<text x="384" y="394">┘</text>
<text x="774" y="394">│</text>
<text x="34" y="414">│</text>
<text x="304" y="414">▼</text>
<text x="774" y="414">│</text>
<text x="34" y="434">│</text>
<text x="234" y="434">整</text>
<text x="254" y="434">個</text>
<text x="274" y="434">步</text>
<text x="294" y="434">驟</text>
<text x="314" y="434">由</text>
<text x="344" y="434">C</text>
<text x="354" y="434">P</text>
<text x="364" y="434">U</text>
<text x="384" y="434">原</text>
<text x="404" y="434">子</text>
<text x="424" y="434">執</text>
<text x="444" y="434">行</text>
<text x="774" y="434">│</text>
<text x="34" y="454">│</text>
<text x="234" y="454">其</text>
<text x="254" y="454">他</text>
<text x="284" y="454">C</text>
<text x="294" y="454">P</text>
<text x="304" y="454">U</text>
<text x="324" y="454">看</text>
<text x="344" y="454">不</text>
<text x="364" y="454">到</text>
<text x="384" y="454">中</text>
<text x="404" y="454">間</text>
<text x="424" y="454">狀</text>
<text x="444" y="454">態</text>
<text x="774" y="454">│</text>
<text x="34" y="474">└</text>
<text x="44" y="474">─</text>
<text x="54" y="474">─</text>
<text x="64" y="474">─</text>
<text x="74" y="474">─</text>
<text x="84" y="474">─</text>
<text x="94" y="474">─</text>
<text x="104" y="474">─</text>
<text x="114" y="474">─</text>
<text x="124" y="474">─</text>
<text x="134" y="474">─</text>
<text x="144" y="474">─</text>
<text x="154" y="474">─</text>
<text x="164" y="474">─</text>
<text x="174" y="474">─</text>
<text x="184" y="474">─</text>
<text x="194" y="474">─</text>
<text x="204" y="474">─</text>
<text x="214" y="474">─</text>
<text x="224" y="474">─</text>
<text x="234" y="474">─</text>
<text x="244" y="474">─</text>
<text x="254" y="474">─</text>
<text x="264" y="474">─</text>
<text x="274" y="474">─</text>
<text x="284" y="474">─</text>
<text x="294" y="474">─</text>
<text x="304" y="474">─</text>
<text x="314" y="474">─</text>
<text x="324" y="474">─</text>
<text x="334" y="474">─</text>
<text x="344" y="474">─</text>
<text x="354" y="474">─</text>
<text x="364" y="474">─</text>
<text x="374" y="474">─</text>
<text x="384" y="474">─</text>
<text x="394" y="474">─</text>
<text x="404" y="474">─</text>
<text x="414" y="474">─</text>
<text x="424" y="474">─</text>
<text x="434" y="474">─</text>
<text x="444" y="474">─</text>
<text x="454" y="474">─</text>
<text x="464" y="474">─</text>
<text x="474" y="474">─</text>
<text x="484" y="474">─</text>
<text x="494" y="474">─</text>
<text x="504" y="474">─</text>
<text x="514" y="474">─</text>
<text x="524" y="474">─</text>
<text x="534" y="474">─</text>
<text x="544" y="474">─</text>
<text x="554" y="474">─</text>
<text x="564" y="474">─</text>
<text x="574" y="474">─</text>
<text x="584" y="474">─</text>
<text x="594" y="474">─</text>
<text x="604" y="474">─</text>
<text x="614" y="474">─</text>
<text x="624" y="474">─</text>
<text x="634" y="474">─</text>
<text x="644" y="474">─</text>
<text x="654" y="474">─</text>
<text x="664" y="474">─</text>
<text x="674" y="474">─</text>
<text x="684" y="474">─</text>
<text x="694" y="474">─</text>
<text x="704" y="474">─</text>
<text x="714" y="474">─</text>
<text x="724" y="474">─</text>
<text x="734" y="474">─</text>
<text x="744" y="474">─</text>
<text x="754" y="474">─</text>
<text x="764" y="474">─</text>
<text x="774" y="474">┘</text>
<text x="34" y="514">C</text>
<text x="44" y="514">A</text>
<text x="54" y="514">S</text>
<text x="74" y="514">自</text>
<text x="94" y="514">旋</text>
<text x="114" y="514">重</text>
<text x="134" y="514">試</text>
<text x="154" y="514">模</text>
<text x="174" y="514">式</text>
<text x="194" y="514">（</text>
<text x="214" y="514">無</text>
<text x="234" y="514">鎖</text>
<text x="254" y="514">計</text>
<text x="274" y="514">數</text>
<text x="294" y="514">器</text>
<text x="314" y="514">的</text>
<text x="334" y="514">典</text>
<text x="354" y="514">型</text>
<text x="374" y="514">用</text>
<text x="394" y="514">法</text>
<text x="414" y="514">）</text>
<text x="434" y="514">：</text>
<text x="34" y="554">┌</text>
<text x="44" y="554">─</text>
<text x="54" y="554">─</text>
<text x="64" y="554">─</text>
<text x="74" y="554">─</text>
<text x="84" y="554">─</text>
<text x="94" y="554">─</text>
<text x="104" y="554">─</text>
<text x="114" y="554">─</text>
<text x="124" y="554">─</text>
<text x="134" y="554">─</text>
<text x="144" y="554">─</text>
<text x="154" y="554">─</text>
<text x="164" y="554">─</text>
<text x="174" y="554">─</text>
<text x="184" y="554">─</text>
<text x="194" y="554">─</text>
<text x="204" y="554">─</text>
<text x="214" y="554">─</text>
<text x="224" y="554">─</text>
<text x="234" y="554">─</text>
<text x="244" y="554">─</text>
<text x="254" y="554">─</text>
<text x="264" y="554">─</text>
<text x="274" y="554">─</text>
<text x="284" y="554">─</text>
<text x="294" y="554">─</text>
<text x="304" y="554">─</text>
<text x="314" y="554">─</text>
<text x="324" y="554">─</text>
<text x="334" y="554">─</text>
<text x="344" y="554">─</text>
<text x="354" y="554">─</text>
<text x="364" y="554">─</text>
<text x="374" y="554">─</text>
<text x="384" y="554">─</text>
<text x="394" y="554">─</text>
<text x="404" y="554">─</text>
<text x="414" y="554">─</text>
<text x="424" y="554">─</text>
<text x="434" y="554">─</text>
<text x="444" y="554">─</text>
<text x="454" y="554">─</text>
<text x="464" y="554">─</text>
<text x="474" y="554">─</text>
<text x="484" y="554">─</text>
<text x="494" y="554">─</text>
<text x="504" y="554">─</text>
<text x="514" y="554">─</text>
<text x="524" y="554">─</text>
<text x="534" y="554">─</text>
<text x="544" y="554">─</text>
<text x="554" y="554">─</text>
<text x="564" y="554">─</text>
<text x="574" y="554">─</text>
<text x="584" y="554">─</text>
<text x="594" y="554">─</text>
<text x="604" y="554">─</text>
<text x="614" y="554">─</text>
<text x="624" y="554">─</text>
<text x="634" y="554">─</text>
<text x="644" y="554">─</text>
<text x="654" y="554">─</text>
<text x="664" y="554">─</text>
<text x="674" y="554">─</text>
<text x="684" y="554">─</text>
<text x="694" y="554">─</text>
<text x="704" y="554">─</text>
<text x="714" y="554">─</text>
<text x="724" y="554">─</text>
<text x="734" y="554">─</text>
<text x="744" y="554">─</text>
<text x="754" y="554">─</text>
<text x="764" y="554">─</text>
<text x="774" y="554">┐</text>
<text x="34" y="574">│</text>
<text x="64" y="574">l</text>
<text x="74" y="574">o</text>
<text x="84" y="574">o</text>
<text x="94" y="574">p</text>
<text x="114" y="574">{</text>
<text x="774" y="574">│</text>
<text x="34" y="594">│</text>
<text x="104" y="594">o</text>
<text x="114" y="594">l</text>
<text x="124" y="594">d</text>
<text x="144" y="594">=</text>
<text x="164" y="594">a</text>
<text x="174" y="594">t</text>
<text x="184" y="594">o</text>
<text x="194" y="594">m</text>
<text x="204" y="594">i</text>
<text x="214" y="594">c</text>
<text x="224" y="594">_</text>
<text x="234" y="594">l</text>
<text x="244" y="594">o</text>
<text x="254" y="594">a</text>
<text x="264" y="594">d</text>
<text x="274" y="594">(</text>
<text x="284" y="594">c</text>
<text x="294" y="594">o</text>
<text x="304" y="594">u</text>
<text x="314" y="594">n</text>
<text x="324" y="594">t</text>
<text x="334" y="594">e</text>
<text x="344" y="594">r</text>
<text x="354" y="594">)</text>
<text x="394" y="594">←</text>
<text x="414" y="594">讀</text>
<text x="434" y="594">取</text>
<text x="454" y="594">當</text>
<text x="474" y="594">前</text>
<text x="494" y="594">值</text>
<text x="774" y="594">│</text>
<text x="74" y="614">│</text>
<text x="774" y="614">│</text>
<text x="34" y="634">│</text>
<text x="104" y="634">n</text>
<text x="114" y="634">e</text>
<text x="124" y="634">w</text>
<text x="144" y="634">=</text>
<text x="164" y="634">o</text>
<text x="174" y="634">l</text>
<text x="184" y="634">d</text>
<text x="204" y="634">+</text>
<text x="224" y="634">1</text>
<text x="394" y="634">←</text>
<text x="414" y="634">計</text>
<text x="434" y="634">算</text>
<text x="454" y="634">期</text>
<text x="474" y="634">望</text>
<text x="494" y="634">新</text>
<text x="514" y="634">值</text>
<text x="774" y="634">│</text>
<text x="74" y="654">│</text>
<text x="774" y="654">│</text>
<text x="34" y="674">│</text>
<text x="104" y="674">i</text>
<text x="114" y="674">f</text>
<text x="134" y="674">C</text>
<text x="144" y="674">A</text>
<text x="154" y="674">S</text>
<text x="164" y="674">(</text>
<text x="174" y="674">c</text>
<text x="184" y="674">o</text>
<text x="194" y="674">u</text>
<text x="204" y="674">n</text>
<text x="214" y="674">t</text>
<text x="224" y="674">e</text>
<text x="234" y="674">r</text>
<text x="244" y="674">,</text>
<text x="264" y="674">o</text>
<text x="274" y="674">l</text>
<text x="284" y="674">d</text>
<text x="294" y="674">,</text>
<text x="314" y="674">n</text>
<text x="324" y="674">e</text>
<text x="334" y="674">w</text>
<text x="344" y="674">)</text>
<text x="364" y="674">{</text>
<text x="394" y="674">←</text>
<text x="414" y="674">原</text>
<text x="434" y="674">子</text>
<text x="454" y="674">地</text>
<text x="474" y="674">「</text>
<text x="494" y="674">確</text>
<text x="514" y="674">認</text>
<text x="534" y="674">沒</text>
<text x="554" y="674">人</text>
<text x="574" y="674">改</text>
<text x="594" y="674">過</text>
<text x="614" y="674">再</text>
<text x="634" y="674">寫</text>
<text x="654" y="674">入</text>
<text x="674" y="674">」</text>
<text x="774" y="674">│</text>
<text x="34" y="694">│</text>
<text x="144" y="694">b</text>
<text x="154" y="694">r</text>
<text x="164" y="694">e</text>
<text x="174" y="694">a</text>
<text x="184" y="694">k</text>
<text x="394" y="694">←</text>
<text x="414" y="694">成</text>
<text x="434" y="694">功</text>
<text x="454" y="694">，</text>
<text x="474" y="694">退</text>
<text x="494" y="694">出</text>
<text x="774" y="694">│</text>
<text x="34" y="714">│</text>
<text x="104" y="714">}</text>
<text x="774" y="714">│</text>
<text x="34" y="734">│</text>
<text x="104" y="734">/</text>
<text x="114" y="734">/</text>
<text x="134" y="734">失</text>
<text x="154" y="734">敗</text>
<text x="174" y="734">：</text>
<text x="194" y="734">說</text>
<text x="214" y="734">明</text>
<text x="244" y="734">c</text>
<text x="254" y="734">o</text>
<text x="264" y="734">u</text>
<text x="274" y="734">n</text>
<text x="284" y="734">t</text>
<text x="294" y="734">e</text>
<text x="304" y="734">r</text>
<text x="324" y="734">已</text>
<text x="344" y="734">被</text>
<text x="364" y="734">其</text>
<text x="384" y="734">他</text>
<text x="404" y="734">執</text>
<text x="424" y="734">行</text>
<text x="444" y="734">緒</text>
<text x="464" y="734">改</text>
<text x="484" y="734">變</text>
<text x="504" y="734">，</text>
<text x="524" y="734">重</text>
<text x="544" y="734">新</text>
<text x="564" y="734">讀</text>
<text x="584" y="734">取</text>
<text x="604" y="734">再</text>
<text x="624" y="734">試</text>
<text x="774" y="734">│</text>
<text x="34" y="754">│</text>
<text x="64" y="754">}</text>
<text x="774" y="754">│</text>
<text x="34" y="774">└</text>
<text x="44" y="774">─</text>
<text x="54" y="774">─</text>
<text x="64" y="774">─</text>
<text x="74" y="774">─</text>
<text x="84" y="774">─</text>
<text x="94" y="774">─</text>
<text x="104" y="774">─</text>
<text x="114" y="774">─</text>
<text x="124" y="774">─</text>
<text x="134" y="774">─</text>
<text x="144" y="774">─</text>
<text x="154" y="774">─</text>
<text x="164" y="774">─</text>
<text x="174" y="774">─</text>
<text x="184" y="774">─</text>
<text x="194" y="774">─</text>
<text x="204" y="774">─</text>
<text x="214" y="774">─</text>
<text x="224" y="774">─</text>
<text x="234" y="774">─</text>
<text x="244" y="774">─</text>
<text x="254" y="774">─</text>
<text x="264" y="774">─</text>
<text x="274" y="774">─</text>
<text x="284" y="774">─</text>
<text x="294" y="774">─</text>
<text x="304" y="774">─</text>
<text x="314" y="774">─</text>
<text x="324" y="774">─</text>
<text x="334" y="774">─</text>
<text x="344" y="774">─</text>
<text x="354" y="774">─</text>
<text x="364" y="774">─</text>
<text x="374" y="774">─</text>
<text x="384" y="774">─</text>
<text x="394" y="774">─</text>
<text x="404" y="774">─</text>
<text x="414" y="774">─</text>
<text x="424" y="774">─</text>
<text x="434" y="774">─</text>
<text x="444" y="774">─</text>
<text x="454" y="774">─</text>
<text x="464" y="774">─</text>
<text x="474" y="774">─</text>
<text x="484" y="774">─</text>
<text x="494" y="774">─</text>
<text x="504" y="774">─</text>
<text x="514" y="774">─</text>
<text x="524" y="774">─</text>
<text x="534" y="774">─</text>
<text x="544" y="774">─</text>
<text x="554" y="774">─</text>
<text x="564" y="774">─</text>
<text x="574" y="774">─</text>
<text x="584" y="774">─</text>
<text x="594" y="774">─</text>
<text x="604" y="774">─</text>
<text x="614" y="774">─</text>
<text x="624" y="774">─</text>
<text x="634" y="774">─</text>
<text x="644" y="774">─</text>
<text x="654" y="774">─</text>
<text x="664" y="774">─</text>
<text x="674" y="774">─</text>
<text x="684" y="774">─</text>
<text x="694" y="774">─</text>
<text x="704" y="774">─</text>
<text x="714" y="774">─</text>
<text x="724" y="774">─</text>
<text x="734" y="774">─</text>
<text x="744" y="774">─</text>
<text x="754" y="774">─</text>
<text x="764" y="774">─</text>
<text x="774" y="774">┘</text>
<text x="34" y="814">A</text>
<text x="44" y="814">B</text>
<text x="54" y="814">A</text>
<text x="74" y="814">問</text>
<text x="94" y="814">題</text>
<text x="114" y="814">（</text>
<text x="134" y="814">C</text>
<text x="144" y="814">A</text>
<text x="154" y="814">S</text>
<text x="174" y="814">的</text>
<text x="194" y="814">已</text>
<text x="214" y="814">知</text>
<text x="234" y="814">陷</text>
<text x="254" y="814">阱</text>
<text x="274" y="814">）</text>
<text x="294" y="814">：</text>
<text x="34" y="854">時</text>
<text x="54" y="854">間</text>
<text x="94" y="854">執</text>
<text x="114" y="854">行</text>
<text x="134" y="854">緒</text>
<text x="164" y="854">T</text>
<text x="174" y="854">1</text>
<text x="324" y="854">執</text>
<text x="344" y="854">行</text>
<text x="364" y="854">緒</text>
<text x="394" y="854">T</text>
<text x="404" y="854">2</text>
<text x="34" y="874">─</text>
<text x="44" y="874">─</text>
<text x="54" y="874">─</text>
<text x="64" y="874">─</text>
<text x="84" y="874">─</text>
<text x="94" y="874">─</text>
<text x="104" y="874">─</text>
<text x="114" y="874">─</text>
<text x="124" y="874">─</text>
<text x="134" y="874">─</text>
<text x="144" y="874">─</text>
<text x="154" y="874">─</text>
<text x="164" y="874">─</text>
<text x="174" y="874">─</text>
<text x="184" y="874">─</text>
<text x="194" y="874">─</text>
<text x="204" y="874">─</text>
<text x="214" y="874">─</text>
<text x="224" y="874">─</text>
<text x="234" y="874">─</text>
<text x="244" y="874">─</text>
<text x="254" y="874">─</text>
<text x="264" y="874">─</text>
<text x="274" y="874">─</text>
<text x="284" y="874">─</text>
<text x="294" y="874">─</text>
<text x="314" y="874">─</text>
<text x="324" y="874">─</text>
<text x="334" y="874">─</text>
<text x="344" y="874">─</text>
<text x="354" y="874">─</text>
<text x="364" y="874">─</text>
<text x="374" y="874">─</text>
<text x="384" y="874">─</text>
<text x="394" y="874">─</text>
<text x="404" y="874">─</text>
<text x="414" y="874">─</text>
<text x="424" y="874">─</text>
<text x="434" y="874">─</text>
<text x="444" y="874">─</text>
<text x="454" y="874">─</text>
<text x="464" y="874">─</text>
<text x="474" y="874">─</text>
<text x="484" y="874">─</text>
<text x="494" y="874">─</text>
<text x="504" y="874">─</text>
<text x="514" y="874">─</text>
<text x="524" y="874">─</text>
<text x="534" y="874">─</text>
<text x="544" y="874">─</text>
<text x="554" y="874">─</text>
<text x="564" y="874">─</text>
<text x="574" y="874">─</text>
<text x="584" y="874">─</text>
<text x="594" y="874">─</text>
<text x="604" y="874">─</text>
<text x="614" y="874">─</text>
<text x="624" y="874">─</text>
<text x="634" y="874">─</text>
<text x="644" y="874">─</text>
<text x="654" y="874">─</text>
<text x="664" y="874">─</text>
<text x="674" y="874">─</text>
<text x="684" y="874">─</text>
<text x="44" y="894">t</text>
<text x="54" y="894">1</text>
<text x="84" y="894">l</text>
<text x="94" y="894">o</text>
<text x="104" y="894">a</text>
<text x="114" y="894">d</text>
<text x="124" y="894">:</text>
<text x="144" y="894">o</text>
<text x="154" y="894">l</text>
<text x="164" y="894">d</text>
<text x="184" y="894">=</text>
<text x="204" y="894">A</text>
<text x="44" y="914">t</text>
<text x="54" y="914">2</text>
<text x="314" y="914">C</text>
<text x="324" y="914">A</text>
<text x="334" y="914">S</text>
<text x="344" y="914">(</text>
<text x="354" y="914">A</text>
<text x="374" y="914">→</text>
<text x="394" y="914">B</text>
<text x="404" y="914">)</text>
<text x="424" y="914">成</text>
<text x="444" y="914">功</text>
<text x="464" y="914">，</text>
<text x="484" y="914">值</text>
<text x="504" y="914">改</text>
<text x="524" y="914">為</text>
<text x="554" y="914">B</text>
<text x="44" y="934">t</text>
<text x="54" y="934">3</text>
<text x="314" y="934">C</text>
<text x="324" y="934">A</text>
<text x="334" y="934">S</text>
<text x="344" y="934">(</text>
<text x="354" y="934">B</text>
<text x="374" y="934">→</text>
<text x="394" y="934">A</text>
<text x="404" y="934">)</text>
<text x="424" y="934">成</text>
<text x="444" y="934">功</text>
<text x="464" y="934">，</text>
<text x="484" y="934">值</text>
<text x="504" y="934">又</text>
<text x="524" y="934">改</text>
<text x="544" y="934">回</text>
<text x="574" y="934">A</text>
<text x="44" y="954">t</text>
<text x="54" y="954">4</text>
<text x="84" y="954">C</text>
<text x="94" y="954">A</text>
<text x="104" y="954">S</text>
<text x="114" y="954">(</text>
<text x="124" y="954">A</text>
<text x="144" y="954">→</text>
<text x="164" y="954">C</text>
<text x="174" y="954">)</text>
<text x="194" y="954">成</text>
<text x="214" y="954">功</text>
<text x="234" y="954">！</text>
<text x="314" y="954">←</text>
<text x="334" y="954">T</text>
<text x="344" y="954">1</text>
<text x="364" y="954">誤</text>
<text x="384" y="954">以</text>
<text x="404" y="954">為</text>
<text x="424" y="954">沒</text>
<text x="444" y="954">人</text>
<text x="464" y="954">動</text>
<text x="484" y="954">過</text>
<text x="504" y="954">，</text>
<text x="524" y="954">但</text>
<text x="544" y="954">其</text>
<text x="564" y="954">實</text>
<text x="584" y="954">發</text>
<text x="604" y="954">生</text>
<text x="624" y="954">了</text>
<text x="654" y="954">A</text>
<text x="664" y="954">→</text>
<text x="674" y="954">B</text>
<text x="684" y="954">→</text>
<text x="694" y="954">A</text>
<text x="34" y="994">解</text>
<text x="54" y="994">法</text>
<text x="74" y="994">：</text>
<text x="94" y="994">使</text>
<text x="114" y="994">用</text>
<text x="134" y="994">帶</text>
<text x="154" y="994">版</text>
<text x="174" y="994">本</text>
<text x="194" y="994">號</text>
<text x="214" y="994">的</text>
<text x="244" y="994">C</text>
<text x="254" y="994">A</text>
<text x="264" y="994">S</text>
<text x="274" y="994">（</text>
<text x="294" y="994">如</text>
<text x="324" y="994">J</text>
<text x="334" y="994">a</text>
<text x="344" y="994">v</text>
<text x="354" y="994">a</text>
<text x="374" y="994">A</text>
<text x="384" y="994">t</text>
<text x="394" y="994">o</text>
<text x="404" y="994">m</text>
<text x="414" y="994">i</text>
<text x="424" y="994">c</text>
<text x="434" y="994">S</text>
<text x="444" y="994">t</text>
<text x="454" y="994">a</text>
<text x="464" y="994">m</text>
<text x="474" y="994">p</text>
<text x="484" y="994">e</text>
<text x="494" y="994">d</text>
<text x="504" y="994">R</text>
<text x="514" y="994">e</text>
<text x="524" y="994">f</text>
<text x="534" y="994">e</text>
<text x="544" y="994">r</text>
<text x="554" y="994">e</text>
<text x="564" y="994">n</text>
<text x="574" y="994">c</text>
<text x="584" y="994">e</text>
<text x="594" y="994">）</text>
<text x="34" y="1014">C</text>
<text x="44" y="1014">A</text>
<text x="54" y="1014">S</text>
<text x="64" y="1014">(</text>
<text x="74" y="1014">a</text>
<text x="84" y="1014">d</text>
<text x="94" y="1014">d</text>
<text x="104" y="1014">r</text>
<text x="114" y="1014">,</text>
<text x="134" y="1014">(</text>
<text x="144" y="1014">e</text>
<text x="154" y="1014">x</text>
<text x="164" y="1014">p</text>
<text x="174" y="1014">e</text>
<text x="184" y="1014">c</text>
<text x="194" y="1014">t</text>
<text x="204" y="1014">e</text>
<text x="214" y="1014">d</text>
<text x="224" y="1014">_</text>
<text x="234" y="1014">v</text>
<text x="244" y="1014">a</text>
<text x="254" y="1014">l</text>
<text x="264" y="1014">,</text>
<text x="284" y="1014">e</text>
<text x="294" y="1014">x</text>
<text x="304" y="1014">p</text>
<text x="314" y="1014">e</text>
<text x="324" y="1014">c</text>
<text x="334" y="1014">t</text>
<text x="344" y="1014">e</text>
<text x="354" y="1014">d</text>
<text x="364" y="1014">_</text>
<text x="374" y="1014">s</text>
<text x="384" y="1014">t</text>
<text x="394" y="1014">a</text>
<text x="404" y="1014">m</text>
<text x="414" y="1014">p</text>
<text x="424" y="1014">)</text>
<text x="434" y="1014">,</text>
<text x="454" y="1014">(</text>
<text x="464" y="1014">n</text>
<text x="474" y="1014">e</text>
<text x="484" y="1014">w</text>
<text x="494" y="1014">_</text>
<text x="504" y="1014">v</text>
<text x="514" y="1014">a</text>
<text x="524" y="1014">l</text>
<text x="534" y="1014">,</text>
<text x="554" y="1014">n</text>
<text x="564" y="1014">e</text>
<text x="574" y="1014">w</text>
<text x="584" y="1014">_</text>
<text x="594" y="1014">s</text>
<text x="604" y="1014">t</text>
<text x="614" y="1014">a</text>
<text x="624" y="1014">m</text>
<text x="634" y="1014">p</text>
<text x="654" y="1014">+</text>
<text x="674" y="1014">1</text>
<text x="684" y="1014">)</text>
<text x="694" y="1014">)</text>
</g>
</svg>
</div>
<p>先比對舊值，符合才寫入新值，不符合就重試。</p>
<h2 id="示意圖"><a class="header" href="#示意圖">示意圖</a></h2>
<pre><code class="language-text">CAS 成功/失敗對比：

  初始：counter = 10

  情況 A（CAS 成功）：
  T1: load=10 → CAS(addr, expect=10, new=11) → 10==10 → swap → counter=11 ✓

  情況 B（CAS 失敗，觸發重試）：
  T1: load=10 → [T2 搶先改成 11] → CAS(addr, expect=10, new=11) → 10≠11 → FAIL
  T1: load=11 → CAS(addr, expect=11, new=12) → 11==11 → swap → counter=12 ✓
</code></pre>
<h2 id="跨語言完整範例"><a class="header" href="#跨語言完整範例">跨語言完整範例</a></h2>
<p>CAS 自旋計數器（多執行緒安全遞增，無鎖實作）。</p>
<h3 id="cgcc-atomic--cas-自旋"><a class="header" href="#cgcc-atomic--cas-自旋">C（GCC atomic + CAS 自旋）</a></h3>
<pre><code class="language-c">#include &lt;stdatomic.h&gt;
#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;

#define THREADS 4
#define ITER    100000

atomic_long counter = 0;

long cas_increment(atomic_long *c) {
    long old, new_val;
    do {
        old = atomic_load_explicit(c, memory_order_relaxed);
        new_val = old + 1;
    } while (!atomic_compare_exchange_weak_explicit(
                 c, &amp;old, new_val,
                 memory_order_release,
                 memory_order_relaxed));
    return new_val;
}

void *worker(void *arg) {
    for (int i = 0; i &lt; ITER; i++)
        cas_increment(&amp;counter);
    return NULL;
}

int main(void) {
    pthread_t tid[THREADS];
    for (int i = 0; i &lt; THREADS; i++)
        pthread_create(&amp;tid[i], NULL, worker, NULL);
    for (int i = 0; i &lt; THREADS; i++)
        pthread_join(tid[i], NULL);
    printf("counter = %ld (expected %d)\n", counter, THREADS * ITER);
    return 0;
}
</code></pre>
<pre><code class="language-bash">gcc -std=c11 -O2 -o cas_counter cas_counter.c -lpthread &amp;&amp; ./cas_counter
</code></pre>
<h3 id="cstdatomic-compare_exchange_weak"><a class="header" href="#cstdatomic-compare_exchange_weak">C++（std::atomic compare_exchange_weak）</a></h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;thread&gt;
#include &lt;atomic&gt;
#include &lt;vector&gt;

const int THREADS = 4, ITER = 100000;
std::atomic&lt;long&gt; counter{0};

void cas_increment(std::atomic&lt;long&gt; &amp;c) {
    long old_val = c.load(std::memory_order_relaxed);
    while (!c.compare_exchange_weak(
               old_val, old_val + 1,
               std::memory_order_release,
               std::memory_order_relaxed))
        ;   // old_val 自動被更新為最新值，繼續重試
}

void worker() {
    for (int i = 0; i &lt; ITER; i++)
        cas_increment(counter);
}

int main() {
    std::vector&lt;std::thread&gt; ts;
    for (int i = 0; i &lt; THREADS; i++) ts.emplace_back(worker);
    for (auto &amp;t : ts) t.join();
    std::cout &lt;&lt; "counter = " &lt;&lt; counter
              &lt;&lt; " (expected " &lt;&lt; THREADS * ITER &lt;&lt; ")\n";
}
</code></pre>
<pre><code class="language-bash">g++ -std=c++17 -O2 -o cas_counter cas_counter.cpp -lpthread &amp;&amp; ./cas_counter
</code></pre>
<h3 id="rustatomici64--compare_exchange"><a class="header" href="#rustatomici64--compare_exchange">Rust（AtomicI64 + compare_exchange）</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::sync::Arc;
use std::sync::atomic::{AtomicI64, Ordering};
use std::thread;

const THREADS: usize = 4;
const ITER: i64 = 100_000;

fn cas_increment(counter: &amp;AtomicI64) {
    loop {
        let old = counter.load(Ordering::Relaxed);
        match counter.compare_exchange_weak(
            old, old + 1,
            Ordering::Release,
            Ordering::Relaxed,
        ) {
            Ok(_) =&gt; break,
            Err(_) =&gt; continue,   // 失敗，重試（old 已自動更新）
        }
    }
}

fn main() {
    let counter = Arc::new(AtomicI64::new(0));
    let mut handles = vec![];
    for _ in 0..THREADS {
        let c = Arc::clone(&amp;counter);
        handles.push(thread::spawn(move || {
            for _ in 0..ITER { cas_increment(&amp;c); }
        }));
    }
    for h in handles { h.join().unwrap(); }
    println!("counter = {} (expected {})", counter.load(Ordering::SeqCst), THREADS as i64 * ITER);
}</code></pre></pre>
<pre><code class="language-bash">cargo run
</code></pre>
<h3 id="gosyncatomic-compareandswap"><a class="header" href="#gosyncatomic-compareandswap">Go（sync/atomic CompareAndSwap）</a></h3>
<pre><code class="language-go">package main

import (
    "fmt"
    "sync"
    "sync/atomic"
)

const threads, iter = 4, 100_000

func casIncrement(counter *int64) {
    for {
        old := atomic.LoadInt64(counter)
        if atomic.CompareAndSwapInt64(counter, old, old+1) {
            break   // 成功
        }
        // 失敗：counter 已被其他 goroutine 改變，重試
    }
}

func main() {
    var counter int64
    var wg sync.WaitGroup
    wg.Add(threads)
    for i := 0; i &lt; threads; i++ {
        go func() {
            defer wg.Done()
            for j := 0; j &lt; iter; j++ {
                casIncrement(&amp;counter)
            }
        }()
    }
    wg.Wait()
    fmt.Printf("counter = %d (expected %d)\n", counter, threads*iter)
}
</code></pre>
<pre><code class="language-bash">go run main.go
</code></pre>
<h3 id="python模擬-casthreadinglock-實作"><a class="header" href="#python模擬-casthreadinglock-實作">Python（模擬 CAS，threading.Lock 實作）</a></h3>
<pre><code class="language-python">import threading

class AtomicInt:
    """模擬 CAS 語意的原子整數（Python 無原生 CAS，用鎖模擬語意）"""
    def __init__(self, value: int = 0):
        self._value = value
        self._lock = threading.Lock()

    def compare_and_swap(self, expected: int, new: int) -&gt; bool:
        with self._lock:
            if self._value == expected:
                self._value = new
                return True
            return False

    def load(self) -&gt; int:
        with self._lock:
            return self._value

def cas_increment(counter: AtomicInt):
    while True:
        old = counter.load()
        if counter.compare_and_swap(old, old + 1):
            break

THREADS, ITER = 4, 100_000
counter = AtomicInt(0)

def worker():
    for _ in range(ITER):
        cas_increment(counter)

if __name__ == "__main__":
    threads = [threading.Thread(target=worker) for _ in range(THREADS)]
    for t in threads: t.start()
    for t in threads: t.join()
    print(f"counter = {counter.load()} (expected {THREADS * ITER})")
</code></pre>
<pre><code class="language-bash">python3 cas_counter.py
</code></pre>
<h2 id="完整專案級範例python"><a class="header" href="#完整專案級範例python">完整專案級範例（Python）</a></h2>
<p>檔案：<code>examples/python/ch05.py</code></p>
<pre><code class="language-bash">python3 examples/python/ch05.py
</code></pre>
<pre><code class="language-python">"""Chapter 05: atomicity with CAS-like primitive.

展示：
1. CAS（Compare-And-Swap）的語意：比對舊值，符合才寫入新值
2. 多執行緒安全遞增（無鎖計數器模擬）
3. CAS 失敗時重試機制
"""
import threading


class AtomicInt:
    def __init__(self, value: int = 0):
        self._v = value
        self._m = threading.Lock()

    def compare_and_swap(self, expect: int, new: int) -&gt; bool:
        with self._m:
            if self._v == expect:
                self._v = new
                return True
            return False

    def get(self) -&gt; int:
        with self._m:
            return self._v


def cas_increment(a: AtomicInt):
    """CAS 自旋重試直到成功。"""
    while True:
        old = a.get()
        if a.compare_and_swap(old, old + 1):
            break


if __name__ == "__main__":
    a = AtomicInt(10)
    print("cas 10-&gt;11", a.compare_and_swap(10, 11), "now", a.get())
    print("cas 10-&gt;12", a.compare_and_swap(10, 12), "now", a.get())  # 失敗，值已是 11

    # 多執行緒 CAS 計數器
    counter = AtomicInt(0)
    THREADS, ITER = 4, 10000
    ts = [threading.Thread(target=lambda: [cas_increment(counter) for _ in range(ITER)])
          for _ in range(THREADS)]
    for t in ts: t.start()
    for t in ts: t.join()
    print(f"final counter = {counter.get()} (expected {THREADS * ITER})")
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch04-atomic-visibility-order.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch06-visibility-order-foundation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch04-atomic-visibility-order.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch06-visibility-order-foundation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
